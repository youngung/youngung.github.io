<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> 수치해석 | 재료역학 연구실 </title> <meta name="author" content=" "> <meta name="description" content="재료공학도를 위한 수치해석"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://youngung.github.io/lectures/2_1_numerical_analysis/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> 재료역학 연구실 </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/blog/">blog </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/equipment/">equipment </a> </li> <li class="nav-item active"> <a class="nav-link" href="/lectures/">lectures <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">수치해석</h1> <p class="post-description">재료공학도를 위한 수치해석</p> </header> <article> <h1 id="orientation">Orientation</h1> <ul> <li>국립창원대학교 재료금속공학과 <ul> <li><a href="mailto:yjeong@changwon.ac.kr">이메일</a></li> <li><a href="https://youngung.github.io">웹페이지</a></li> </ul> </li> <li>실습 환경 <ul> <li> <a href="https://code.visualstudio.com" rel="external nofollow noopener" target="_blank">VScode</a> + <a href="https://jupyter.org" rel="external nofollow noopener" target="_blank">Jupyter</a> </li> <li> <a href="https://github.com" rel="external nofollow noopener" target="_blank">GitHub</a> 계정을 만들고 결합하길 권함.</li> <li>Windows, MacOS, Linux 등 다양한 컴퓨터 환경에서 실습 가능함.</li> <li>구글 계정을 활용해서 <a href="https://colab.google" rel="external nofollow noopener" target="_blank">Google Colab</a>과 <a href="https://drive.google.com/" rel="external nofollow noopener" target="_blank">Google Drive</a>을 결함한 형태로 Cloud service를 활용해서, 인터넷 연결된 웹브라우저를 활용해서 실습 가능하나 추천하진 않음.</li> </ul> </li> </ul> <h1 id="수업-목표">수업 목표</h1> <ul> <li>기초 수치해석을 이해하고, Python 등의 프로그램을 활용해 수치해석에 활요할 수 있다.</li> </ul> <h1 id="week1">Week1</h1> <h2 id="수업-01-1-오리엔테이션">수업 01-1 (오리엔테이션)</h2> <ul> <li>대상 <ul> <li>국립창원대학교 재료금속공학과 2학년 학생</li> <li>수치해석은 <strong>전공필수</strong> 교과로써 반드시 이수하여야만 졸업 가능</li> <li>수업을 원활히 이해하기 위해서는 <strong>mse_data</strong> 강의를 선수강할 필요 있음</li> </ul> </li> <li>준비물 <ul> <li>강의자료는 <a href="https://youngung.github.io/teaching">여기</a>에서 찾을 수 있음</li> <li>개인용 컴퓨터</li> <li>노트</li> <li>수업자료 출력물</li> <li>Python, Jupyter notebook 등에 대한 기본적 이해와 활용 능력</li> <li>Numpy, Matplotlib 등 주요 Python library에 대한 이해와 활용 능력</li> <li> <strong>pip</strong> 활용해서 필요한 패키지를 제때 설치할 수 있어야 함.</li> </ul> </li> <li>평가 <ul> <li>출석 (50%) - 출석이 매우 중요 - 앞선 주차의 내용을 이해 못하면 중도 탈락하게 됨 반드시 빠지지 않고 참석해야 함</li> <li>태도 점수, 참여가 저조하거나, 뒷자리 앉아서 수업에 참여하지 않으면 F</li> <li>강의에 필요한 준비물이 갖춰져 있지 않으면 출석 인정 안됨</li> <li>중간 / 기말 평가 <ul> <li>강의 내용에 대한 이론 평가</li> <li>강의 내용을 스스로 프로그램/디버깅 하여 만들 수 있어야 함.</li> </ul> </li> </ul> </li> <li>강의 <ul> <li>수치해석은 <strong>전공필수</strong> 입니다. F학점으로는 졸업이 불가능합니다.</li> <li>반드시 스스로 실습해야함. 증명뿐만 아니라, 컴퓨터 코딩까지 <strong>스스로</strong>해야 함. <h2 id="수업-01-2-수치해석-전반-설명">수업 01-2 (수치해석 전반 설명)</h2> <h1 id="week2">Week2</h1> <h2 id="수업-02-1-수와-오차-error">수업 02-1 (수와 오차 Error)</h2> </li> </ul> </li> <li>컴퓨터의 수 <ul> <li>컴퓨터가 다루는 수에는 항상 오차가 있다. (한정된 메모리)</li> </ul> </li> <li>수의 종류 <ul> <li>정수 (integer): …, -2, -1, 0, 1, 2, …</li> <li>유리수 (rational): 분수로 나타낼 수 있는 수 (1/2, 2/3, 0.5, …)</li> <li>무리수 (irrational): 소수로 끝없이 이어지는 수 (3.141592… , 1.414213…, Euler’s number) <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">pi:</span><span class="sh">'</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span>
<span class="c1"># 내 컴퓨터에서는 3.141592653589793 까지만 출력되었다.
# 여러분들 컴퓨터는 어떤가?
</span><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">Euler number:</span><span class="sh">'</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="c1"># 마찬가지로 2.718281828459045 까지만 출력되었다.
</span></code></pre></div> </div> </li> </ul> </li> <li>오차의 종류 <ul> <li>(1) 반올림 오차 (round-off error). 메모리가 유한하므로, <em>유한한</em> 자리수까지만 저장한다. 예: <code class="language-plaintext highlighter-rouge">0.3333..</code>을 소수점 네자리까지만 저장하면 0.3333이 되고, 진짜 값과 ‘오차’가 생깁니다. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="o">+</span> <span class="mf">0.2</span>
<span class="nf">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>   <span class="c1"># 0.30000000000000004
</span></code></pre></div> </div> <p>위 예시에서, 컴퓨터는 2진법으로 수를 저장하다 보니, 정확히 0.3이 계산되지 않고, 오차가 생깁니다.</p> </li> <li> <p>(2) 절단 오차 (truncation error) 무한한 계산 과정을 중간에 끊어서 근사(approximation)할 때 생기는 오차에요. 예를 들어, Taylor급수로 \(\sin{x}\)를 표현하면,</p> \[\sin x= \sum_{n=0}^\infty\frac{(-1)^n}{(2n+1)!}x^{2n+1}\] <p>따라서 만약 n=0,..,3까지만 전개해보면 아래와 같다.</p> \[\sin x\approx \frac{1}{1!}x^1 +\frac{-1^1}{3!}x^3 +\frac{(-1)^2}{5!}x^5 +\frac{-1^3}{7!}x^7\] <p>우선 Factorial을 구현할 Python 함수를 구해보자.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">factorial</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">val</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">val</span><span class="o">=</span><span class="n">val</span><span class="o">*</span><span class="n">i</span>
    <span class="k">return</span> <span class="n">val</span>

<span class="c1">## Test factorial function
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s">! = </span><span class="si">{</span><span class="nf">factorial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div> </div> <p>실은 math library에 이미 factorial 함수가 존재한다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">math</span>
<span class="n">math</span><span class="p">.</span><span class="nf">factorial</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</code></pre></div> </div> <p>그 다음으로 테일러 급수를 함수로 표현해보면…</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">sinx_taylor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">fin</span><span class="p">):</span>
    <span class="n">val</span><span class="o">=</span><span class="mf">0.</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">fin</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">term</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">n</span><span class="o">/</span><span class="p">(</span><span class="nf">factorial</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="c1"># print(f'{n}-th term: {term}')
</span>        <span class="n">val</span><span class="o">+=</span><span class="n">term</span>
    <span class="k">return</span> <span class="n">val</span>
</code></pre></div> </div> <ul> <li>테일러 항 차수에 따라 달라지는 오차의 변화를 살펴보자. <ul> <li>n값의 변화에 따라서,</li> <li>여러 x값에서 Taylor 급수와의 차이값을 그려보자. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>  <span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
  <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
  <span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span><span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span>

  <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">actual</span><span class="sh">'</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">10</span><span class="p">):</span>
      <span class="n">ys</span><span class="o">=</span><span class="nf">sinx_taylor</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
      <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="s">Taylor series n=</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="p">.</span><span class="nf">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul> </li> <li> <p>에제: \(y=e^x\)</p> <p>이 함수의 테일러 시리즈는 다음과 같다: \(e^x=\sum_{n=0}^{\infty}\frac{1}{n!}x^n\)</p> <ul> <li> <p>\(n=4\)까지 전개 하면:</p> \[e^x=1+x+1/2x^2+1/6x^3+1/24x^4 ...\] </li> <li> <p>이 둘을 직접 그려보고 얼마나 유사한지 살펴보자</p> </li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>  <span class="k">def</span> <span class="nf">taylor_ex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">n</span><span class="p">):</span>
      <span class="n">s</span><span class="o">=</span><span class="mf">0.</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
          <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="o">+</span><span class="mf">1.</span><span class="o">/</span><span class="nf">factorial</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
      <span class="k">return</span> <span class="n">s</span>

  <span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="sh">'</span><span class="s">k-</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$y=e^x$</span><span class="sh">'</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">):</span>
      <span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="nf">taylor_ex</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">n</span><span class="p">),</span> <span class="c1">#continued
</span>          <span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">rf</span><span class="sh">'</span><span class="s">Taylor series up to $n=$</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>

  <span class="n">plt</span><span class="p">.</span><span class="nf">ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
  <span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> </li> <li> <p>에제: \(y=\cos(x)\)의 테일러 급수를 사용해서 \(n=1,4,7,10\)까지 경우를 나타내고 실제 y=cos(x)함수와의 차이를 비교해보자.</p> </li> <li> <p>예제: \(y=\ln(1+x)\) 여기서 \(x\)의 범위는 \(x\in(-1,1]\)</p> </li> <li>예제: Maclaurin series expansion for chemical potential (?)</li> </ul> </li> </ul> </li> <li>오차 측정 방법 <ul> <li> <p>(1) 절대 오차 (absolute error)</p> \[E^a=|x^{true}-x^{approx}|\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">x_true</span><span class="o">=</span><span class="mi">3</span>
<span class="n">x_approx</span><span class="o">=</span><span class="mf">3.5</span>
<span class="n">err_rel</span><span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">x_true</span><span class="o">-</span><span class="n">x_approx</span><span class="p">)</span>
</code></pre></div> </div> </li> <li> <p>(2) 상대 오차 (relative error)</p> \[E^r=\frac{|x^{true}-x^{approx}|}{|x^{true}|}\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">x_true</span><span class="o">=</span><span class="mi">3</span>
<span class="n">x_approx</span><span class="o">=</span><span class="mf">3.5</span>
<span class="n">err_rel</span><span class="o">=</span> <span class="nf">abs</span><span class="p">(</span><span class="n">x_true</span><span class="o">-</span><span class="n">x_approx</span><span class="p">)</span><span class="o">/</span><span class="nf">abs</span><span class="p">(</span><span class="n">x_true</span><span class="p">)</span>
</code></pre></div> </div> <p>** 상대 오차를 사용할 수 없는 경우는 언제일까?</p> </li> <li> <p>(3) 수열의 오차?</p> <p>만약 수열 \(\boldsymbol{x}\)가 여러 값으로 이루어진 배열이라면?</p> <p>각 배열내의 요소의 절대 오차가 아래와 같이 정의되겠다.</p> \[E_i=|x^{true}_i-x^{approx}_i|\] <p>전체 수열의 오차를 구하면?</p> \[\sum_iE_i=|x^{true}_i-x^{approx}_i|\] <p>혹은 아래와 같이 표현이 더욱 유용할 수 있겠다.</p> \[Error=\sqrt{\sum_i(x^{true}_i-x^{approx}_i)^2}\] <p>위와 같은 수열의 오차를 표현하자면 아래와 같다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span> <span class="c1"># numpy 패키지 활용
</span><span class="n">x_true</span>  <span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span>  <span class="mi">1</span><span class="p">,</span>   <span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">])</span>
<span class="n">x_approx</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.3</span><span class="p">,</span><span class="o">-</span><span class="mf">1.9</span><span class="p">,</span><span class="mf">4.3</span><span class="p">]</span> <span class="p">)</span>

<span class="n">summedup</span><span class="o">=</span><span class="mf">0.</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">x_true</span><span class="p">)):</span>
  <span class="n">summedup</span><span class="o">+=</span><span class="p">(</span><span class="n">x_true</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">x_approx</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span>
<span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">summedup</span><span class="p">)</span>

<span class="c1">## 혹은 Numpy의 broadcasting 기능과 .sum() method 활용해
## 더욱 축약해 아래와 같이 표현할 수 있겠다.
</span><span class="n">error</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(((</span><span class="n">x_true</span><span class="o">-</span><span class="n">x_approx</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nf">sum</span><span class="p">())</span>
</code></pre></div> </div> </li> <li> <p>두 벡터</p> \[\boldsymbol a, \boldsymbol b\] <p>가 서로 얼마나 유사한지 살펴보려면, 아래와 같이 단순한 차로 살펴볼 수 있을까?</p> \[\boldsymbol a -\boldsymbol b=?\] <p>위의 결과는 scalar가 아닌 또 다른 벡터의 결과로 이어진다.</p> <p>앞서 수열에 대한 오차를 표기했듯 아래 표현이 더 적절하겠다.</p> \[Error=\sqrt{(a_1-b_1)^2+(a_2-b_2)^2+(a_3-b_3)^2}\] <p>혹은 위의 수열에 대한 오차를 표기했듯</p> \[Error=\sqrt{\sum_i^3(a_i-b_i)^2}\] <p>라 표기할 수 있겠다. 그리고 이는 더욱 축약하자면</p> \[Error=|\boldsymbol a- \boldsymbol b|\] <p>와 같이 표기할 수 있겠다.</p> <p>만약 상대 오차를 구한다면?</p> \[Error=\frac{|\boldsymbol a- \boldsymbol b|}{0.5(|\boldsymbol a|+|\boldsymbol b|)}\] <p>혹은 더욱 명백하게 인덱스 notation을 활용해 표현하자면 아래와 같이 나타낼 수 있다.</p> \[Error=\frac{\sqrt{(a_1-b_1)^2+(a_2-b_2)^2+(a_3-b_3)^2}}{0.5\big(\sqrt{a_1^2+a_2^2+a_3^2}+\sqrt{b_1^2+b_2^2+b_3^2}\big)}\] <p>위에 제시된 오차의 정의를 파이썬으로 표현해보자.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="k">def</span> <span class="nf">get_abs</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Function that calculates the magnitude of
    given vector `v`

    Arguments
    ---------
    v

    Returns
    -------
    the magnitude of given vector v
    </span><span class="sh">"""</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1">## two vectors
</span><span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.</span> <span class="p">,</span><span class="mf">2.</span> <span class="p">,</span><span class="mf">3.</span> <span class="p">])</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="mf">1.2</span><span class="p">,</span><span class="mf">1.9</span><span class="p">,</span><span class="mf">3.1</span><span class="p">])</span>

<span class="c1">## absolute error between the two vectors
</span><span class="n">err</span><span class="o">=</span><span class="nf">get_abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">1 error:</span><span class="sh">'</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
<span class="c1">## Relative error between the two vectors
</span><span class="n">err</span><span class="o">=</span><span class="nf">get_abs</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span> <span class="c1">#분자까지만,
</span><span class="n">err</span><span class="o">=</span><span class="n">err</span><span class="o">/</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="nf">get_abs</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">+</span><span class="nf">get_abs</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="c1"># 분모로 나누면..
</span><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">2 error:</span><span class="sh">'</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul> </li> </ul> <h2 id="수업-02-2-컴퓨터의-유한-정밀도-floating-point-개념">수업 02-2 (컴퓨터의 유한 정밀도 (floating point 개념))</h2> <ul> <li>유한정밀도 <ul> <li>컴퓨터는 0과 1 (이진수, binary)만 저장할 수 있음.</li> <li>무리수를 비롯한 실수(real number)는 무한히 많은 자리수 (3.141592…)를 가질 수 있으나, 메모리가 한정되어 정해진 비트 수까지만 저장가능함 (32비트, 62비트 등)</li> <li>그로인해 수를 근사치로 저장하고 표현함; 유한한 정밀도를 가짐 (finite precision)</li> </ul> </li> <li>부동 소수점 (Float point) (cf. &lt;-&gt; 고정 소수점 (Fixed piont)) <ul> <li>수를 저장하는 방식 부호(sign), 지수(exponent), 가수(mantisa)를 각각 이진법(0 혹은 1)로 표현함.</li> </ul> \[값=(-1)^{sign}\times (1+mantisa)\times 2 ^{exponent-bias}\] <ul> <li>예 10진수 5.75를 저장하기 <ul> <li>5 = <code class="language-plaintext highlighter-rouge">101</code> </li> <li> <p>0.75 = <code class="language-plaintext highlighter-rouge">0.11</code></p> <p>0.75를 이진수로 만들기 위해서는 우선 2를 곱한다: \(0.75\times 2 = 1.5\) 실수 <code class="language-plaintext highlighter-rouge">1</code>을 제외한 나머지 <code class="language-plaintext highlighter-rouge">0.5</code>에 다시 2를 곱한다. \(0.5\times 2 = 1.0\) 실수 <code class="language-plaintext highlighter-rouge">1</code>을 제외한 나머지가 0이 되어 사라질때까지 반복한다. 따라서 5.75 = <code class="language-plaintext highlighter-rouge">101.11</code> 가 된다. 이 값을 정규화와 부호 및 지수 처리를 한 후 저장.</p> </li> <li> <p>정규화(normalization)</p> <p><a href="https://en.wikipedia.org/wiki/IEEE_754" rel="external nofollow noopener" target="_blank">IEEE 754</a>에 의하여 항상 수를</p> \[1.\text{XXXX..} \times 2^n\] <p>형태로 바꿔서 저장함. 따라서 이진수 <code class="language-plaintext highlighter-rouge">101.11</code>을 아래와 같이 변환:</p> \[101.11\rightarrow1.\green{0111}\times 2^{\red{2}}\] <p>위와 같이 저장하면 두 부분의 수가 저장되어야 함.</p> <ul> <li>가수(mantissa) = \(\green{0111}0000...\) (정해진 칸내에서 유효숫자 뒤는 0으로 채운다.)</li> <li>지수(exponent) = \(\red{2}\)</li> <li>base가 <code class="language-plaintext highlighter-rouge">2</code>인 이유는 이진법을 활용하기 때문에…</li> </ul> </li> <li> <p>부호</p> <p><code class="language-plaintext highlighter-rouge">5.75</code>는 양수 이므로, 부호는 양수로 저장 (부호비트 이진수 = <code class="language-plaintext highlighter-rouge">0</code>)</p> </li> <li> <p>지수</p> <p><a href="https://en.wikipedia.org/wiki/IEEE_754" rel="external nofollow noopener" target="_blank">IEEE 754</a>에 의하여 지수를 바이어스(bias) 방식으로 저장한다.</p> <ul> <li> <a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format" rel="external nofollow noopener" target="_blank">double precision</a>의 바이어스는 = \(\blue{1023}\)</li> <li>실제 지수는: \(\red{2}\).</li> <li>저장되는 지수는: \(\red{2}+\blue{1023}=1025\)</li> <li>따라서 바이어스 처리된 1025를 아래와 같이 2진수로 표현하면? <div class="language-text highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>         몫    나머지
---------------------
1025 / 2 = 512 ... 1
512 / 2  = 256 ... 0
256 / 2  = 128 ... 0
128 / 2  = 64  ... 0
64 / 2   = 32  ... 0
32 / 2   = 16  ... 0
16 / 2   = 8   ... 0
8 / 2    = 4   ... 0
4 / 2    = 2   ... 0
2 / 2    = 1   ... 0
1 / 2    = 0   ... 1
</code></pre></div> </div> <p><code class="language-plaintext highlighter-rouge">10000000001</code>가 된다 (11비트, 즉 2진법으로 11자리)</p> </li> </ul> </li> <li> <p>가수 (Mantissa, fraction)</p> <p>정규화된 수 \(1.0111 \times 2^2\)에서 앞의 1은 항상 생략(숨겨진 1), 따라서 저장되는 건 0111 뒤에 0으로 채운 52비트입니다. mantissa = 0111000…0 (52비트)</p> </li> <li> <code class="language-plaintext highlighter-rouge">5.75</code>를 <a href="https://en.wikipedia.org/wiki/IEEE_754" rel="external nofollow noopener" target="_blank">IEEE 754</a> 방식으로 저장한다면.. <ul> <li>부호 = <code class="language-plaintext highlighter-rouge">0</code> (1비트, 즉 0(+) 또는 1(-))</li> <li>지수 = <code class="language-plaintext highlighter-rouge">10000000000</code> (11비트)</li> <li>가수 = <code class="language-plaintext highlighter-rouge">0111000000000000000000000000000000000000000000000000</code> (52비트)</li> <li>따라서 전체는 <code class="language-plaintext highlighter-rouge">0</code> <code class="language-plaintext highlighter-rouge">10000000000</code> <code class="language-plaintext highlighter-rouge">0111000000000000000000000000000000000000000000000000</code> </li> </ul> </li> </ul> </li> <li>예, 10진수 1.5를 저장하기. <ul> <li>1=<code class="language-plaintext highlighter-rouge">1</code> </li> <li> <p>0.5 = ?</p> \[0.5 \times 2 = 1.0\] <p>실수 <code class="language-plaintext highlighter-rouge">1</code>이 나온다. 따라서 0.5=<code class="language-plaintext highlighter-rouge">1.1</code>이 된다.</p> </li> <li> <p>정규화는?</p> \[1.\text{XXXX...} \times 2^n\] <p>으로 해야하므로,</p> \[1.1\rightarrow1.1 \times 2^0\] <p>가수/지수를 구하면</p> <ul> <li>가수 = \(10000...\)</li> <li>지수 = 0</li> </ul> </li> <li>부호 =0</li> <li>지수는 바이어스로 저장한다 (1023). 따라서 <ul> <li> \[0+1023=1023\] </li> <li>바이어스 처리된 1023을 이진수로 표현하면? <div class="language-text highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>1023/2=511 ... 1
511 /2=255 ... 1
255 /2=127 ... 1
127 /2=63  ... 1
63  /2=31  ... 1
31  /2=15  ... 1
15  /2=7   ... 1
7   /2=3  ... 1
3   /2=1  ... 1
1.  /2=0. ... 1
</code></pre></div> </div> <p>따라서 <code class="language-plaintext highlighter-rouge">1111111111</code>가 된다.</p> </li> </ul> </li> <li>가수 정규화된 수 \(1.1\times 2^0\)에서 앞자리 1은 숨기고, 나머지 <code class="language-plaintext highlighter-rouge">1</code>뒤에 0을 채운 52비트.</li> <li>총정리하자면 <ul> <li>부호=<code class="language-plaintext highlighter-rouge">0</code> (1비트)</li> <li>지수=<code class="language-plaintext highlighter-rouge">01111111111</code> (11비트)</li> <li>가수=<code class="language-plaintext highlighter-rouge">1000000000000000000000000000000000000000000000000000</code> (52비트) <code class="language-plaintext highlighter-rouge">0</code> <code class="language-plaintext highlighter-rouge">01111111111</code> <code class="language-plaintext highlighter-rouge">1000000000000000000000000000000000000000000000000000</code> </li> </ul> </li> <li>만약 32비트를 사용하면 0.5가 어떻게 저장될까? <ul> <li>32비트 컴퓨터의 바이어스는 127이고, 부호는 1비트, 지수는 8비트, 맨티사는 23비트를 사용한다.</li> </ul> </li> </ul> </li> </ul> </li> <li>유한 정밀도 (finite precision)의 한계 <ul> <li>가수부가 52비트로 제한되어 있음. 약 15~16자리 10진수까지만 정확히 표현 가능</li> <li>그 이후 자리수는 ‘잘림’(truncation)</li> <li>반올림 오차가(round-off error)가 발생</li> <li>한계 사례 <ul> <li>0.1 을 저장한다면… 0.1=<code class="language-plaintext highlighter-rouge">0.00011001100110011 ...</code> (무한 반복되어 정확히 저장 불가)</li> <li>큰 수와 작은수를 더할 때 \(10^{16}+1-10^{16}=?\) <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="nf">print</span><span class="p">(</span><span class="mf">1e16</span><span class="o">+</span><span class="mi">1</span><span class="o">-</span><span class="mf">1e16</span><span class="p">)</span>
</code></pre></div> </div> </li> <li>연산 순서에 따라 결과가 달라질 수 있음 <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="c1"># 예제 1: 큰 수 + 작은 수
</span><span class="n">a</span> <span class="o">=</span> <span class="mf">1e16</span>   <span class="c1"># 매우 큰 수
</span><span class="n">b</span> <span class="o">=</span> <span class="mf">1.0</span>    <span class="c1"># 작은 수
</span><span class="n">c</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e16</span>  <span class="c1"># 큰 음수
</span>
<span class="n">res1</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">c</span>
<span class="n">res2</span> <span class="o">=</span> <span class="n">a</span> <span class="o">+</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">(a + b) + c =</span><span class="sh">"</span><span class="p">,</span> <span class="n">res1</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="s">a + (b + c) =</span><span class="sh">"</span><span class="p">,</span> <span class="n">res2</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul> </li> <li>ex: 0.80</li> </ul> </li> </ul> <h1 id="week3">Week3</h1> <ul> <li>목표 <ul> <li>방정식을 해석적(analytic)으로 그리고 수치적(numerical)으로 푸는 방법 비교</li> <li>Bisection method 이해하고, 활용할 수 있다.</li> </ul> </li> </ul> <h2 id="수업-03-1">수업 03-1</h2> <ul> <li> <p>(방정식을 왜 수치적으로 풀어야 하나), 해석적 풀이 vs. 수치적 풀이, 2차 방정식 손계산</p> </li> <li>해석적 풀이가 가능한 경우 <ul> <li> <p>1차, 2차 방정식: 공식 존재</p> <p>$a x^{2} + b x + c = 0 $의 근의 공식</p> \[x=\frac{-b\pm\sqrt{b^2-4ac}}{2a}\] </li> </ul> </li> <li>해석적 풀이가 불가능하거나 매우 복잡한 경우 <ul> <li> <a href="https://ko.wikipedia.org/wiki/%EC%98%A4%EC%B0%A8_%EB%B0%A9%EC%A0%95%EC%8B%9D" rel="external nofollow noopener" target="_blank">5차이상의 다항식의 경우, 근의 공식 없음</a> (사칙연산이나, 거듭 제곱근 등, 손으로 계산 못한다.) 하지만 실근은 존재한다.</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">poly</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    polynomial function
    </span><span class="sh">"""</span>
    <span class="n">n</span><span class="o">=</span><span class="nf">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">y</span><span class="o">=</span><span class="mf">0.</span>
    <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">n,i,arg</span><span class="sh">'</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">arg</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">arg</span><span class="p">)</span>
        <span class="n">y</span><span class="o">+=</span><span class="n">arg</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="n">n</span><span class="p">)</span>
        <span class="n">n</span><span class="o">-=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">y</span>

<span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">1.3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
<span class="n">ys</span><span class="o">=</span><span class="nf">poly</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="sh">'</span><span class="s">-</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div> </div> <ul> <li> <p>\(x=\cos(x)\) 만족하는 \(x\)값 구하기. 근은 분명 존재한다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="n">x</span>

<span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="nf">func</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$y=\cos(x)$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">axhline</span><span class="p">(</span><span class="n">c</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> </li> </ul> </li> <li>이분법(bisection method) <ul> <li>원리: <ul> <li>\(f(x)=0\)가 연속일 때, 두 점 \(a,b\)에서 함수값의 부호가 다르면, 그 사이에 반드시 해가 있다. (중간값 정리, Intermediate Value Theorem)</li> <li>즉, [a, b] 구간에서 근이 있음을 알면 구간을 절반으로 줄여가며 해를 찾는 방법</li> </ul> </li> </ul> </li> </ul> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>	&lt;img src="https://upload.wikimedia.org/wikipedia/commons/c/c2/Bisection_method.png" alt="drawing" width="400"/&gt;
</code></pre></div></div> <ul> <li> <p>알고리듬:</p> </li> <li> <p>시작 구간 \([a,b]\) 선택:</p> <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>    $$f(a)×f(b)&lt;0$$

    위가 반드시 만족되어야 함 (근이 반드시 존재)

  - 위와 같은 조건 만족하는 $$a,b$$ 값의 중간 값 $$c$$ 구하기.

    $$c=\frac{a+b}{2}$$

  - f(c)의 부호 확인

    + case 1.

      $$f(a)\times f(c)&lt;0$$

      근이 $$[a,c]$$ 안에 존재

    + case 2.

      $$f(c)\times f(b)&lt;0$$

      근이 $$[c,b]$$ 안에 존재

  - 새로운 구간을 $$[a,c]$$ 또는 $$[c,b]$$로 좁힘

  - 원하는 허용 구간 내 오차가 나올 때 까지 반복.

    $$E^a \leq Tol. $$

* 예제

  방정식 $$x^2=2$$를 풀어보자.

  + 구간선택:

  $$[a,b]=[1,2]$$

  + 조건 탐색

      $$f(1)=-1,f(2)=2$$

      부호가 다르므로, 선택된 구간 $$[1,2]$$ 안에 해 존재.

  + 중점 설정

      $$c=\frac{a+b}{2}=1.5$$

  + 조건 탐색

     $$f(1.5)=0.25&gt;0$$

  + 구간 조정

      따라서 근은 $$[1,1.5]$$ 범위 내 존재

  - 다시 중점 설정

      $$c=\frac{a+b}{2}=1.25$$

    + 조건 탐색

      $$f(125)=-0.4375&lt;0$$

    + 구간 조정

      따라서 근은 $$[1.25,1.5]$$사이에 존재

  - 중점 빛 범위의 구간 설정을 반복하여 수정하며 오차 좁힘.

  ```python
  def f(x): ## f(x)=x^2-2 함수
      return x**2 - 2
  a=1
  b=2
  tol=1e-10
  error=tol*2
  if f(a) * f(b) &gt; 0:
      print("root not in [a, b]")
  k=0
  while error&gt;tol: #(b - a) / 2 &gt; tol:
      c = (a + b) / 2 # center
      if f(a) * f(c) &lt; 0: # opposite sign
          b = c # update b
      else:
          a = c # or update a
      error=(b-a)/2.
      k=k+1
  print('total iteration:',k)
  ```

  - 내 컴퓨터에서는 33번 반복해야 $$10^{-10}$$ 허용오차 범위내의 근을 구할 수 있었다.

  - 아래 예시를 통해 upper limit (파란색), lower limit (빨간색)이 반복 횟수에 따라 변하는 과정을 살펴보자.

  ```python
  def f(x): ## f(x)=x^2-2 함수
      return x**2 - 2
  a=1
  b=2
  tol=1e-2
  error=tol*2
  if f(a) * f(b) &gt; 0:
      print("root not in [a, b]")
  k=0
  while error&gt;tol: #(b - a) / 2 &gt; tol:
      plt.plot(k,a,'ro')
      plt.plot(k,b,'bo')
      c = (a + b) / 2 # center
      plt.plot(k,c,'g+')
      if f(a) * f(c) &lt; 0: # opposite sign
          b = c # update b
      else:
          a = c # or update a
      error=(b-a)/2.
      k=k+1

  print('total iteration:',k,'root:',c)
  print('a,b:',a,b)
  plt.plot(np.nan,'ro',label='a')
  plt.plot(np.nan,'bo',label='b')
  plt.plot(np.nan,'g+',label='center')
  plt.xlabel('iteration')
  plt.ylabel('Range')
  plt.legend()
  ```
</code></pre></div> </div> </li> </ul> <h2 id="수업-03-2-newton-raphson-1">수업 03-2 (Newton-Raphson 1)</h2> <ul> <li> <p><a href="https://ko.wikipedia.org/wiki/%EC%9D%B4%EB%B6%84%EB%B2%95_(%EC%88%98%ED%95%99)" rel="external nofollow noopener" target="_blank">Bisection method</a></p> <p>원리가 쉽고 그리고 근을 찾긴 하지만, 때로는 너무 많은 반복 계산을 필요로 한다. 더욱 빠르고 효율적인 방법이 없을까?</p> </li> <li> <p>아래 그림의 알고리듬을 반복.</p> <p><img src="/assets/dat_files/lectures/2_1_numerical_analysis/nr.gif" alt="imag"></p> </li> <li> <p>예제</p> <p>방정식 \(x^2=2\)를 풀어보자.</p> <ul> <li>해석적 해:</li> </ul> \[x=\pm\sqrt{2}\] <ul> <li> <p>수치적 해?</p> <p>알고리듬 (점화식)이 다음과 같다.</p> \[x_{n+1}=x_n-\frac{x_n^2-2}{2x_n}\] <p>오차가 항상 있으므로, 허용가능한 오차(tolerance)를 설정해야 하겠다. 절대 오차를 아래와 같이 정의하고, 허용가능한 오차를 \(10^{-10}\)으로 설정하자. \(E^a = |x_{n+1}^2-2|\leq 10^{-10}\)</p> <p>이 알고리듬은 처음 추측값(\(x_0\))이 필요하다. 이를 \(x_0=+1\)로 설정하고 알고리듬을 적용해보자.</p> <ul> <li> <p>At \((n=0)\)</p> \[x_0=+1\] </li> <li> <p>At \(n=1\)</p> \[x_1=x_0-\frac{x_0^2-2}{2x_0}=1-\frac{1^2-2}{2}=1+0.5=1.5\] \[E^a=|1.5^2-2|=0.25 \ge10^{-10} \therefore \text{not accurate enough}\] </li> <li> <p>At \(n=2\)</p> \[x_2=x_1-\frac{x_1^2-2}{2x_1}=1.5-\frac{1.5^2-2}{3}=1.4166666...\] \[E^a=|1.4166...^2-2|=0.006944...\times 10^{-6}\ge10^{-10} \therefore \text{not accurate enough}\] </li> <li> <p>At \(n=3\)</p> \[x_3=x_2-\frac{x_2^2-2}{2x_2}=1.41421568 ...\] \[E^a=6.007..\times10^{-6}\ge10^{-10} \therefore \text{not accurate enough}\] </li> <li> <p>At \(n=4\)</p> \[x_4=x_3-\frac{x_3^2-2}{2x_3}=1.41421356237...\] \[E^a=4.51\times10^{-12}\red{\lt}10^{-10} \therefore \text{accurate enough!}\] </li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>

<span class="n">x</span><span class="o">=</span><span class="mi">1</span> <span class="c1">## initial guess
</span><span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">initial guess</span><span class="sh">'</span><span class="p">)</span>
<span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="nf">while</span><span class="p">(</span><span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span> <span class="ow">and</span> <span class="n">k</span><span class="o">&lt;</span> <span class="mi">10</span><span class="p">):</span> <span class="c1">## k counts the number of iteration.
</span>    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">err</span><span class="p">)</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">err</span><span class="o">&lt;=</span><span class="n">tol</span><span class="p">)</span>
    <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span>
    <span class="c1">## see the trend.
</span>    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_%i$</span><span class="sh">'</span><span class="o">%</span><span class="n">k</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">err</span><span class="p">,</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">#ax2.set_yscale('log')
</span><span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> <ul> <li>Repeat the above with changing the initial guess \(x_0=-1\).</li> <li>\(y=x^2-2\) 그래프를 실제로 그리고, 반복할 때 마다 어떻게 값이 변하고 있는지 살펴보자.</li> </ul> </li> </ul> </li> <li> <p>예제</p> <p>방정식 \(x^2=3\)를 풀어보자.</p> <ul> <li> <p>주어진 알고리듬은 아래와 같다.</p> \[x_{n+1}=x_{n} - \frac{x_n^{2}-3}{2x_{n}}\] </li> </ul> </li> <li> <p>예제</p> <p>방정식 \(x^{4}=2\)를 풀어보자.</p> <ul> <li> <p>주어진 알고리듬은 아래와 같다.</p> \[x_{n+1}=x_n-\frac{x_n^4-2}{4x_n^3}\] </li> </ul> </li> <li> <p>예제</p> <p>방정식 \(\ln{x}=1\)를 풀어보자.</p> <ul> <li> <p>주어진 알고리듬은 아래와 같다.</p> \[x_{n+1}=x_n-\frac{\ln(x_n)-1}{1/x_n}\] </li> </ul> </li> <li> <p>예제</p> <p>방정식 \(\cos{x}=0.3\)를 풀어보자.</p> <ul> <li> <p>주어진 알고리듬은 아래와 같다.</p> \[x_{n+1}=x_n-\frac{\cos(x_n)-0.3}{-\sin(x_n)}\] </li> </ul> </li> <li> <p>물음: 위 예제에서 보이는 특정 규칙을 찾아보자.</p> </li> <li> <p>물음: 초기값을 바꿔보고 그 영향을 살펴보자.</p> </li> </ul> <h1 id="week4-newton-raphson-2">Week4 (Newton-Raphson 2)</h1> <h2 id="수업-04-1-taylor-series와-newton-raphson-법">수업 04-1 Taylor series와 Newton-Raphson 법</h2> <ul> <li>개념 <ul> <li> <p>아래 형태의 함수의 답을 구하고 싶을 때 사용할 수 있다.</p> \[f(x)=0\] </li> <li> <p>예: \(x^2=2\) 의 해를 구하기 위해서는</p> \[f(x)=x^2-2=0\] <p>위의 해를 구하면 되겠다.</p> </li> <li>Bisection method는 항상 해를 구할 수 있지만, Newton Raphson은 가끔 해를 못구할 때도 (해를 구하는데 실패할 수) 있다.</li> <li>하지만 Bisection method에 비해 훨씬 빠르게 해를 찾을 수 있다.</li> <li>‘접선’을 활용해 해를 빠르게 찾아간다.</li> <li>미지수가 둘 이상은 경우에도 활용가능하다 (Advanced) <ul> <li>\(f(x,y)=0\) 혹은 \(\boldsymbol f(\boldsymbol v)=0\) 에도 활용 가능.</li> </ul> </li> </ul> </li> <li> <p>Newton Raphson 방법의 도출 1</p> <ul> <li>주어진 첫 guess 를 \(x^{(0)}\)라 하자.</li> </ul> </li> <li> <p>Newton Raphson 방법의 도출 2</p> <p><a href="https://ko.wikipedia.org/wiki/%ED%85%8C%EC%9D%BC%EB%9F%AC_%EA%B8%89%EC%88%98" rel="external nofollow noopener" target="_blank">테일러 급수(Taylor series)</a>로부터 <a href="https://ko.wikipedia.org/wiki/%EB%89%B4%ED%84%B4_%EB%B0%A9%EB%B2%95" rel="external nofollow noopener" target="_blank">Newton Raphson</a> 방법 도출</p> <ul> <li> <p>함수 \(f(x)\) 의 테일러 급수에 의하면</p> \[f(x)=\sum_{n=0}\] \[f(x)=\sum_{n=0}^{\infty}\frac{f^{(n)}(a)}{n!}(x-a)^n =f(a)+f^\prime(a)(x-a)+\frac{1}{2}f^{\prime\prime}(a)(x-a)^2+\frac{1}{6}f^{\prime\prime\prime}(a)(x-a)^3 + ...\] </li> <li> <p>Example of \(f(x)=x^2\) 의 경우?</p> \[f(x)=x^2\] \[f^\prime(x)=2x\] \[f^{\prime\prime}(x)=2\] \[f^{\prime\prime\prime}(x)=0.\] <p>따라서, 이어서 나오는 고차 항의 도함수는 0이 되며 기여하는 바가 없게 된다. 다시 테일러 급수의 정의를 따라,</p> <ul> <li> <p>\(a=0\)일 때의 경우(Maclaurin series)를 살펴보면</p> \[f(x)=f(0)+f^\prime(0)x+\frac{1}{2}f^{\prime\prime}(0)x^2 \newline =0+0\times x+1/2\times 2\times x^2=x^2\] </li> <li> <p>\(a=1\)일 때의 경우에는?</p> \[f(x)=f(1)+f^\prime(1)(x-1)+\frac{1}{2}f^{\prime\prime}(1)(x-1)^2 \newline =1+2(x-1)+(x-1)^2 \newline =1+2x-2+x^2-2x+1=x^2\] </li> </ul> </li> <li> <p>Newton-Raphson 식 도출 (1st order)</p> \[f(x)=0\] <p>을 풀이하는 문제가 있다 가정하자. 이때 이를 위 의 \(a\)값을 \(x_n\)라 놓고 풀면</p> \[f(x)=f(x_n)+f^\prime(x_n)(x-x_n)+\frac{1}{2}f^{\prime\prime}(x_n)(x-x_n)^2+ ...\] <p>여기서 \(n=1\)까지 항만 고려한다면..</p> \[f(x)\approx f(x_n)+f^\prime(x_n)(x-x_n)\] <p>우리가 풀이하고자 하는 조건에 의하면 \(f(x)=0\) 이므로</p> \[0\approx f(x_n)+f^\prime(x_n)(x-x_n)\] <p>따라서 \(x\)에 대해 풀이하면</p> \[-\frac{f(x_n)}{f^\prime(x_n)}\approx x-x_n\] <p>아래가 도출된다.</p> \[\rightarrow x\approx x_n-\frac{f(x_n)}{f^\prime(x_n)}\] <p>이 때 근사된 \(x\)을 다음번 추측값 \(x_{n+1}\)이라 하면 Newton-Raphson에 활용되는 반복식이 얻어진다.</p> </li> <li> <p>2nd order Newton-Raphson 식</p> <ul> <li>Taylor 공식에서 2차 오더까지 사용하면 어떠한 Newton-Raphson식이 도출되나?</li> <li> <p>도출</p> \[f(x)\approx f(x_n)+f^\prime(x_n)(x-x_n)+\frac{1}{2}f^{\prime\prime}(x_n)(x-x_n)^2\] <p>급수의 중심을 바꾸기 위해 \(h\)값을 아래와 같이 도입하자</p> \[h=x-x_n\] <p>그러면 2차항까지의 테일러 급수가 아래와 같이 표현된다.</p> \[f(x_n+h)\approx f(x_n)+f^\prime(x_n)h+\frac{1}{2}f^{\prime\prime}(x_n)h^2\] <p>그 다음 좌항이 0이 되면</p> \[0\approx f(x_n)+f^\prime(x_n)h+\frac{1}{2}f^{\prime\prime}(x_n)h^2\] <p>\(h\)에 대한 2차 방정식이므로, 근의 공식을 사용하면</p> \[h=\frac{-f^\prime(x_n)\pm\sqrt{[f^\prime(x_n)]^2-2f(x_n)f^{\prime\prime}(x_n)}}{f^{\prime\prime}(x_n)}\] <p>위 계산으로 구해진 \(h\)를 활용해서</p> \[x_{n+1}=x_{n}+h\] </li> <li> <p>주의</p> <p>근의 공식에 따른 두 \(h\)값 중에 무엇을 선택해야 하나? 대부분의 경우 두 값을 비교하여 더욱 작은 \(h\)값을 활용한다.</p> </li> </ul> </li> </ul> </li> <li>예제 <ul> <li>방정식 \(x^2+x=10\)을 풀어보자.</li> <li> <p>우선 \(f(x)=0\) 형태로 바꿔 표현하면,</p> \[f(x)=x^2+x-10=0\] <p>혹은</p> \[f(x)=-x^2-x+10=0\] <p>이 된다. 사실 어느 쪽을 고르나 동일한 알고리듬이 적용 가능하다. 전자의 경우를 선택하고 파이썬으로 함수 \(f(x)\)를 표현해보자.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x</span><span class="o">-</span><span class="mi">10</span>
</code></pre></div> </div> <p>풀이에 의하면 함수의 도함수 \(f^\prime(x)\)도 필요하다. 따라서,</p> \[f^\prime(x)=\frac{\partial f(x)}{\partial x}=2x+1\] <p>파이썬으로 표현하자면</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">fprime</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
  <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">+</span><span class="mi">1</span>
</code></pre></div> </div> <p>이를 활요해 아래 알고리듬에 대입하면</p> \[x_{n+1}\leftarrow x_n-\frac{f(x_n)}{f^\prime(x_n)}\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># initial guess
</span><span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nf">fprime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</code></pre></div> </div> <p>여기에 tolerance를 추가한다면</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># initial guess
</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span>
<span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span><span class="p">:</span>
    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">-</span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nf">fprime</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div> </div> <ul> <li>초기값을 바꿔보고 그 영향을 살펴보자.</li> </ul> </li> </ul> </li> <li> <p><strong>고급 예제</strong>: 위 경우를 아래와 같이 2nd order Taylor expansion을 활용해 작성해보자.</p> \[h=\frac{-f^\prime(x_n)\pm\sqrt{[f^\prime(x_n)]^2-2f(x_n)f^{\prime\prime}(x_n)}}{f^{\prime\prime}(x_n)}\] <p>위 계산으로 구해진 $h$를 활용해서</p> \[x_{n+1}=x_{n}+h\] </li> <li> <p>아래는 Halley’s method으로 알려진 방법이다.</p> \[x_{n+1}=x_n-\frac{2f(x_n)f^\prime(x_n)}{2[f^\prime(x_n)]^2-f(x_n)f^{\prime\prime}(x_n)}\] <p>이를 활용해</p> \[f(x)=\cos(x)e^{3x}-3=0\] <p>을 만족하는 \(x\)값을 구하시오.</p> </li> <li>1st and 2nd order Newton-Raphson과 Halley’s method 비교 예제 <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">3</span>
<span class="k">def</span> <span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">fpp</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">3</span><span class="o">+</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="mi">9</span>
<span class="k">def</span> <span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1"># 2nd order NR
</span>    <span class="n">F</span><span class="o">=</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p</span><span class="o">=</span><span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">pp</span><span class="o">=</span><span class="nf">fpp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="n">det</span><span class="o">=</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">pp</span>
    <span class="n">det</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">det</span><span class="p">)</span>
    <span class="n">h1</span><span class="o">=-</span><span class="n">p</span><span class="o">+</span><span class="n">det</span>
    <span class="n">h1</span><span class="o">=</span><span class="n">h1</span><span class="o">/</span><span class="n">pp</span>

    <span class="n">h2</span><span class="o">=-</span><span class="n">p</span><span class="o">-</span><span class="n">det</span>
    <span class="n">h2</span><span class="o">=</span><span class="n">h2</span><span class="o">/</span><span class="n">pp</span>
    <span class="k">if</span> <span class="nf">abs</span><span class="p">(</span><span class="n">h1</span><span class="p">)</span><span class="o">&lt;</span><span class="nf">abs</span><span class="p">(</span><span class="n">h2</span><span class="p">):</span> <span class="k">return</span> <span class="n">h1</span>
    <span class="k">else</span><span class="p">:</span> <span class="k">return</span> <span class="n">h2</span>

<span class="k">def</span> <span class="nf">Halley</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="c1">## Halley's term
</span>    <span class="n">F</span><span class="o">=</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">p</span><span class="o">=</span><span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">pp</span><span class="o">=</span><span class="nf">fpp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">2</span><span class="o">*</span><span class="n">F</span><span class="o">*</span><span class="n">p</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">F</span><span class="o">*</span><span class="n">pp</span><span class="p">)</span>

<span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ys</span><span class="o">=</span><span class="nf">func</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>

<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">)</span>

<span class="n">xinit</span><span class="o">=-</span><span class="mf">0.1</span>
<span class="n">tol</span><span class="o">=</span><span class="mf">1e-10</span>
<span class="c1">## Newton Raphson
</span><span class="n">x</span><span class="o">=</span><span class="n">xinit</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span><span class="p">:</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">ko</span><span class="sh">'</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">ko</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">x</span><span class="o">+=-</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="nf">fp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="c1">## 2nd order
</span><span class="n">x</span><span class="o">=</span><span class="n">xinit</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span><span class="p">:</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">r+</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">r+</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">x</span><span class="o">+=+</span><span class="nf">h</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># here it is + sign.
</span>    <span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>

<span class="c1">## Halley's method
## 2nd order
</span><span class="n">x</span><span class="o">=</span><span class="n">xinit</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="n">i</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span><span class="p">:</span>
    <span class="nf">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">bx</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">),</span><span class="sh">'</span><span class="s">bx</span><span class="sh">'</span><span class="p">)</span>
    <span class="n">x</span><span class="o">-=</span><span class="nc">Halley</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># note the minus sign here!
</span>    <span class="n">err</span><span class="o">=</span><span class="nf">abs</span><span class="p">(</span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
</code></pre></div> </div> </li> </ul> <h2 id="수업-04-2-2차-방정식-풀이-python-module-만들기">수업 04-2 (2차 방정식 풀이 Python module 만들기)</h2> <ul> <li> <strong>고급 예제</strong>: 임의의 2차 함수의 해를 찾는 script를 작성해보자.</li> <li> <strong>고급 예제</strong>: CLI 환경에서 \(a,b,c\) 를 줬을 때, \(ax^2+bx+c=0\)의 해를 찾는 모듈을 만들어보자. <h1 id="week5-연립-방정식">Week5 (연립 방정식)</h1> <h2 id="수업-05-1-연립-방정식-소개">수업 05-1 (연립 방정식 소개)</h2> </li> <li> <p>2원 연립 방정식</p> \[\bigg( \begin{matrix} 2x+y=5 \ \ \text{eq. (1)}\\ x-y=-1 \ \ \text{eq. (2)} \end{matrix}\] <p>미지수가 \(x,y\) 두 개 (2원), 식도 2개!</p> <ul> <li>대입법 (손으로 풀이) <ul> <li> <p>식 (2)를 바꿔서 \(y=x+1\) 이라 정리되고, 이를 다시 식 (1)에 대입하면,</p> </li> <li> <p>식 (1)이</p> \[2x+(x+1)=5\] <p>로 바뀌고</p> \[3x=4\rightarrow x=4/3\] <p>따라서</p> \[y=4/3+1=7/3\] </li> <li> <p>주어진 연립방정식을 만족하는 \((x,y)\) 짝을 완성</p> \[x=4/3, y=7/3\] </li> </ul> </li> <li> <p>가감법 (덧셈이나 뺄셈을 활용해 손으로 풀이)</p> <ul> <li> <p>식 (1)+식(2) 혹은 식 (1) - 식(2) 등을 활용</p> </li> <li> <p>식 (1)과 식(2)를 더하면</p> \[3x=4\] <p>따라서 \(x\)와 \(y\)를 이어 구할 수 있다.</p> </li> </ul> </li> </ul> </li> <li> <p>기하학적 의미 2원 1차 연립 방정식에서 각 방정식은 각기 다른 ‘직선’을 의미</p> \[2x+y=5 \rightarrow y=-2x+5\] \[x-y=-1 \rightarrow y=x+1\] <p>두 직선의 교점 \((x,y)=(3/4,7/3)\)</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="c1">## the two lines
</span><span class="k">def</span> <span class="nf">y1</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
<span class="k">def</span> <span class="nf">y2</span><span class="p">(</span><span class="n">x</span><span class="p">):</span> <span class="k">return</span> <span class="n">x</span><span class="o">+</span><span class="mi">1</span>

<span class="n">xs</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span> <span class="c1">## -10~10 범위 내의 선 그리기
</span><span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="nf">y1</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="sh">'</span><span class="s">r-</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Line 1</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="nf">y2</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span><span class="sh">'</span><span class="s">b-</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Line 2</span><span class="sh">'</span><span class="p">)</span>

<span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span><span class="mi">7</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="c1"># actual solution
</span><span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="o">*</span><span class="n">xy</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">+</span><span class="sh">'</span><span class="p">,</span><span class="n">mfc</span><span class="o">=</span><span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">,</span><span class="n">mec</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># deco
</span><span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> </li> <li> <p>3원 연립 방정식</p> \[\bigg( \begin{matrix} 2x+y+z=5 \ \ \text{eq. (1)}\\ x-y-z=-1 \ \ \text{eq. (2)}\\ x+5y+2z=0 \ \ \text{eq. (3)} \end{matrix}\] <p>미지수가 \(x,y,z\) 세 개 (3원), 식도 3개!</p> </li> <li> <p>기하학적 의미? 서로 다른 세 면이 만나는 점.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">widget</span>

<span class="k">def</span> <span class="nf">z1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">5</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="o">-</span><span class="n">y</span>
<span class="k">def</span> <span class="nf">z2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">-</span><span class="n">y</span><span class="o">+</span><span class="mi">1</span>
<span class="k">def</span> <span class="nf">z3</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="nf">return </span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">-</span><span class="mi">5</span><span class="o">*</span><span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mf">2.</span>

<span class="n">nres</span><span class="o">=</span><span class="mi">10</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">nres</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">nres</span><span class="p">)</span>
<span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
<span class="n">zz1</span><span class="o">=</span><span class="nf">z1</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">zz2</span><span class="o">=</span><span class="nf">z2</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>
<span class="n">zz3</span><span class="o">=</span><span class="nf">z3</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">)</span>

<span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">()</span>
<span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
<span class="n">kws</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">r</span><span class="sh">'</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz2</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">g</span><span class="sh">'</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz3</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">b</span><span class="sh">'</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>

<span class="c1">## actual point
</span><span class="n">xyz</span><span class="o">=</span><span class="mf">1.3333333</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">4.3333333</span>
<span class="n">ax1</span><span class="p">.</span><span class="nf">scatter</span><span class="p">(</span><span class="o">*</span><span class="n">xyz</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="sh">'</span><span class="s">k</span><span class="sh">'</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="sh">'</span><span class="s">o</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul> <h2 id="수업-05-2-행렬을-활용한-풀이">수업 05-2 (행렬을 활용한 풀이)</h2> <ul> <li>2원 연립 방정식 풀이 <ul> <li> <p>우선 풀이를 위해서는 연립 방정식을 행렬의 형태로 바꿔야 한다.</p> \[\bigg( \begin{matrix} 2x+y=5 \ \ \text{eq. (1)}\\ x-y=-1 \ \ \text{eq. (2)} \end{matrix}\] <p>을 다음의 행렬 형태로 바꾸자.</p> \[\begin{bmatrix} 2&amp; 1\\ 1&amp;-1\\ \end{bmatrix} \begin{bmatrix} x\\ y \end{bmatrix} = \begin{bmatrix} 5\\ -1 \end{bmatrix}\] <p>위처럼 연립 방정식을 행렬의 형태로 바꿔서 풀이할 수 있다. 따라서 연립 방정식을 행렬 형태로 바꾸는 연습이 필요.</p> </li> <li>예시 <ul> <li>아래 연립 방정식을 행렬의 형태로 바꿔보세요. \(\bigg( \begin{matrix} x-5=y \\ y-3x+3=0 \end{matrix}\) <ul> <li>답 \(\begin{bmatrix} 1&amp;-1\\ -3&amp;1\\ \end{bmatrix} \begin{bmatrix} x\\ y \end{bmatrix} = \begin{bmatrix} 5\\ -3 \end{bmatrix}\)</li> </ul> </li> <li>아래 연립 방정식을 행렬의 형태로 바꿔보세요. \(\bigg( \begin{matrix} x=y \\ y=3+x \end{matrix}\) <ul> <li>답 \(\begin{bmatrix} 1&amp;-1\\ 1&amp;-1\\ \end{bmatrix} \begin{bmatrix} x\\ y \end{bmatrix} = \begin{bmatrix} 0\\ -3 \end{bmatrix}\) ** 하나의 형태로만 답이 나오는 건 아닙니다. 예를 들어 위의 경우 \(\begin{bmatrix} 1&amp;-1\\ -1&amp;1\\ \end{bmatrix} \begin{bmatrix} x\\ y \end{bmatrix} = \begin{bmatrix} 0\\ 3 \end{bmatrix}\) 으로 표기될 수 있습니다. 하지만 형태가 다르더라도 정답은 동일하게 도출됩니다.</li> </ul> <p>** 그리고 위의 경우에는 해가 없습니다!! 왜 그럴까요?</p> </li> </ul> </li> <li> <p>해가 없는 경우?</p> \[\bigg( \begin{matrix} 2x+y=5 \ \ \text{eq. (1)}\\ 2x+y=-1 \ \ \text{eq. (2)} \end{matrix}\] <p>위 연립방정식을 만족하는 해는 없습니다. 왜 그럴까요?</p> </li> <li> <p>행렬을 보고 해가 없는 경우를 ‘판별’할 수 있을까요? 판별(determination)하기 위해 우리는 ‘판별값’ 혹은 ‘판별식’이라고 불리는 <a href="https://ko.wikipedia.org/wiki/%ED%96%89%EB%A0%AC%EC%8B%9D" rel="external nofollow noopener" target="_blank">determinant</a>를 구해서 알 수 있다.</p> <ul> <li> <p>예를 들어, 2x2행렬의 경우</p> \[\begin{bmatrix} a &amp; b\\ c &amp; d \end{bmatrix}\] <p>의 판별값을 아래와 같이 표기한다.</p> \[\begin{vmatrix} a &amp; b\\ c &amp; d \end{vmatrix} =ad-bc\] </li> <li> <p>3x3행렬의 경우</p> \[\begin{bmatrix} a &amp; b\\ c &amp; d \end{bmatrix}\] <p>의 판별값을 아래와 같이 표기한다.</p> \[\begin{vmatrix} a &amp; b &amp; c \\ d&amp;e&amp;f\\ g&amp;h&amp;i \end{vmatrix} =aei+bfg+cdh-ceg-bdi-afh\] </li> </ul> </li> <li>행렬로 표현된 연립방정식은 여러 ‘규칙성’을 가진 알고리듬을 통해 그 해를 구할 수 있습니다. <ul> <li>행렬로 표현된 수식을 풀이하는 방법은 크게 2가지로 나뉠 수 있음. <ul> <li>직접해법 (direct method) <ul> <li><a href="https://ko.wikipedia.org/wiki/%EA%B0%80%EC%9A%B0%EC%8A%A4_%EC%86%8C%EA%B1%B0%EB%B2%95" rel="external nofollow noopener" target="_blank">가우스 소거법 (Gauss elimination)</a></li> <li><a href="https://ko.wikipedia.org/wiki/LU_%EB%B6%84%ED%95%B4" rel="external nofollow noopener" target="_blank">LU 분해법 (Low and Upper triangle decomposition)</a></li> <li>수치 안정성이 높음</li> </ul> </li> <li>반복해법 (iterative method) <ul> <li>Jacobi method</li> <li>Gauss-Seidel method</li> <li>반복해법은 발산하는 경우가 더러 있음. 항상 해를 찾을 수 있지 않음. 따라서 수치안정성이 낮음</li> </ul> </li> </ul> </li> <li>가우스 소거법 <ul> <li>기본 개념 <ol> <li>확장행렬(augmented matrix) 만들기</li> <li>두행 (가로줄)의 교환</li> <li>한 행에 0이 아닌 상수를 곱함 (scaling)</li> <li>한행에 다른 행의 배수를 더함 (row addition)</li> <li>2-4을 반복하며 삼각형 모양의 행렬을 만듦</li> <li>Diagnolization</li> <li>삼각형 행렬이 다 만들어지면 아래에서부터 거꾸로 대입 (back-substitution)</li> </ol> </li> <li> <p>예를 들어 아래 행렬식을 푼다면</p> \[\begin{bmatrix} 2&amp; 3 &amp; 1 \\ 1&amp; -1 &amp; 1\\ 3&amp; 11 &amp; 5 \end{bmatrix} \begin{bmatrix} x\\ y\\ z \end{bmatrix} = \begin{bmatrix} 9\\ 1\\ 35 \end{bmatrix}\] <ol> <li> <p>우선 좌변의 3x3행렬과 우변의 3x1’벡터’를 결합한 3x4확장 행렬을 만듭니다.</p> \[\left[ \begin{array}{ccc|c} 2&amp; 3 &amp; 1 &amp; 9\\ 1&amp; -1 &amp; 1 &amp; 1\\ 3&amp; 11 &amp; 5 &amp; 35 \end{array} \right] \begin{array}{c} \text{1st row}\\ \text{2nd row}\\ \text{3rd row} \end{array} \begin{array}{c} \text{irow=0}\\ \text{irow=1}\\ \text{irow=2} \end{array}\] <p>그리고 이를 행렬 \(\boldsymbol A\)라 부릅시다. 따라서 아래와 같습니다.</p> \[\begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} &amp; A_{14} \\ A_{21} &amp; A_{22} &amp; A_{23} &amp; A_{24} \\ A_{31} &amp; A_{32} &amp; A_{33} &amp; A_{34} \\ \end{bmatrix} = \left[ \begin{array}{ccc|c} 2&amp; 3 &amp; 1 &amp; 9\\ 1&amp; -1 &amp; 1 &amp; 1\\ 3&amp; 11 &amp; 5 &amp; 35 \end{array} \right]\] <p>파이썬을 활용해 구현한다면 아래와 같습니다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="sh">'</span><span class="s">%+7.2f</span><span class="sh">'</span><span class="p">):</span>
     <span class="sh">"""</span><span class="s">
     Function to more neatly print out the matrix.
     </span><span class="sh">"""</span>
     <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>
     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">As</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
         <span class="n">cr</span><span class="o">=</span><span class="sh">''</span>
         <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">As</span><span class="p">):</span>
             <span class="n">cr</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">cr</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="sh">'</span><span class="o">%</span><span class="n">a</span>
         <span class="nf">print</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>

 <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span> <span class="c1"># 3 x 4 (three rows, four columns) (3행, 4열)
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="c1">#irow=0
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#irow=1
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">35</span> <span class="c1">#irow=2
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="c1">## 말끔하게 행렬을 소수 2째자리 까지만 출력해서 봅시다.
</span></code></pre></div> </div> <p>위에서 함수 <code class="language-plaintext highlighter-rouge">show</code>는 행렬을 말끔하게 출력하기 위해서 간략히 작성해 봤습니다.</p> </li> <li>행의 위치를 교환합니다 (optional입니다. 하지만 truncation 오차를 줄여줍니다). <ul> <li>첫번째 열(즉 <code class="language-plaintext highlighter-rouge">A[:,0]</code>)의 절대값이 높은 순서대로 아래에서부터 위로 채웁니다.</li> <li>1열 즉</li> </ul> \[\begin{bmatrix} \blue{2}&amp;\blue{...}\\ \red{1}&amp;\red{...}\\ \green{3}&amp;\green{...} \end{bmatrix}\] <p>을 따라서, 3번째 행(3rd row)의 1열(1st col.) 값, 즉 \(A_{13}\)의 절대 값</p> \[|A_{13}|=\green{3}\] <p>이며 가장 큰 수입니다. 그 다음이 \(|A_{11}|=\blue{2}, A_{12}=\red{1}\) 순서입니다.</p> \[\left[ \begin{array}{ccc|c} \red{1}&amp; \red{-1} &amp; \red{1} &amp; \red{1}\\ \blue{2}&amp; \blue{3} &amp; \blue{1} &amp; \blue{9}\\ \green{3}&amp; \green{11} &amp; \green{5} &amp; \green{35} \end{array} \right] \begin{array}{c} \text{2nd row}\rightarrow\text{3rd row}\\ \text{1st row}\rightarrow\text{2nd row}\\ \text{3rd row}\rightarrow\text{1st row} \end{array}\] <p>행렬 옆에 표기된 방법대로 row를 바꾸면</p> \[\left[ \begin{array}{ccc|c} \green{3}&amp; \green{11} &amp; \green{5} &amp; \green{35} \\ \blue{2}&amp; \blue{3} &amp; \blue{1} &amp; \blue{9}\\ \red{1}&amp; \red{-1} &amp; \red{1} &amp; \red{1} \end{array} \right]\] <p>위 순서 까지를 Python 코드로 옮기면</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1">#------------------------------------------------
</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="c1"># initial empty A.
</span> <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
 <span class="c1"># filling up the matrix.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="c1">#1st row, irow=0
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#2nd row, irow=1
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">35</span> <span class="c1">#3rd row, irow=2
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1">## copy to a temp matrix, and named it `B`
</span> <span class="n">A</span><span class="p">[::]</span><span class="o">=</span><span class="mf">0.</span>   <span class="c1">## zeroed.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="c1"># 3rd row [3,11,5,35] -&gt; 1st row
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="c1"># 1st row [2, 3, 1,9] -&gt; 2nd row
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="c1"># 2nd row [1,-1, 1,1] -&gt; 3rd row
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> <p>그런데, \(A\) 행렬의 순서를 바꾸는 걸 Python에게 시키고 싶다면 <a href="https://numpy.org/doc/stable/reference/generated/numpy.argsort.html" rel="external nofollow noopener" target="_blank">np.argsort</a>를 다음과 같이 활용할 수 있겠다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="nf">print</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">])</span> <span class="c1">#1열 - 혹은 A[0:3,0]
</span> <span class="c1"># 위 결과는 [2,1,3] 순서가 된다. 그런데 우리는 절대 값의 순서가 필요.
</span> <span class="c1"># 따라서 np.abs 을 활용해 절대값을
</span> <span class="nf">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
 <span class="c1"># 1열을 따라 낮은 값에서 순서대로 인덱스를 저장.
</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]))</span>
 <span class="c1">#
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">,:])</span>       <span class="c1">#낮은-&gt;높은 값 순서대로 바뀜.
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],:])</span> <span class="c1">#높은-&gt;낮은 값 순서대로... ind[::-1]
</span></code></pre></div> </div> </li> <li>전진 소거 (forward elimination) <ul> <li>앞서 재 정렬된 행렬은 아래와 같다.</li> </ul> \[\boldsymbol A= \left[ \begin{array}{ccc|c} \green{3}&amp; \green{11} &amp; \green{5} &amp; \green{35} \\ \blue{2}&amp; \blue{3} &amp; \blue{1} &amp; \blue{9}\\ \red{1}&amp; \red{-1} &amp; \red{1} &amp; \red{1} \end{array} \right]\] <ul> <li>첫번째 행의 첫번째 렬 값, <code class="language-plaintext highlighter-rouge">A[0,0]</code>, 즉 \(\green{3}\)을 분자로 그리고 \(\blue{\text{row2}}\), 첫번째 렬(col1) 값, 즉 \(A_{21}\), <code class="language-plaintext highlighter-rouge">A[1,0]</code>\(=\blue{2}\)을 분모로 하는 factor \(\frac{\green{3}}{\blue{2}}\)을 두번째 행, <code class="language-plaintext highlighter-rouge">A[1,:]</code>에 곱해서 첫번째 행에서 뺀 후, 두번째 행을 대체합니다. Python으로 정리하면 아래와 같습니다.</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1"># irow=1
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
</code></pre></div> </div> <ul> <li>위 작업을 3번째 행에도 동일하게 수행하면</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1"># irow=2
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span>
</code></pre></div> </div> <ul> <li>그런데 이를 한번에 loop안에 적용할 수 있습니다. 즉:</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1">#------------------------------------------------
</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="c1"># initial empty A.
</span> <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
 <span class="c1"># filling up the matrix.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="c1">#1st row, irow=0
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#2nd row, irow=1
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">35</span> <span class="c1">#3rd row, irow=2
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="nf">copy</span><span class="p">()</span> <span class="c1">## copy to a temp matrix, and named it `B`
</span> <span class="n">A</span><span class="p">[::]</span><span class="o">=</span><span class="mf">0.</span>   <span class="c1">## zeroed.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="c1"># 3rd row [3,11,5,35] -&gt; 1st row
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span> <span class="c1"># 1st row [2, 3, 1,9] -&gt; 2nd row
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">B</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span> <span class="c1"># 2nd row [1,-1, 1,1] -&gt; 3rd row
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">):</span>
   <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> </li> <li>다시 행교환 <ul> <li>이제 행렬은 아래와 같은 형태가 됩니다.</li> </ul> \[\boldsymbol A= \left[ \begin{array}{ccc|c} \green{3}&amp; \green{11} &amp; \green{5} &amp; \green{35} \\ \blue{0}&amp; \blue{6.5} &amp; \blue{3.5} &amp; \blue{21.5}\\ \red{0}&amp; \red{14} &amp; \red{2} &amp; \red{32} \end{array} \right]\] <p>이제 우리의 기준은 \(A_{22}\) 즉 <code class="language-plaintext highlighter-rouge">A[1,1]</code>입니다. 그런데 \(|\blue{6.5}|&lt;|\red{14}|\) 이므로 행 교환이 필요합니다.</p> \[\boldsymbol A= \left[ \begin{array}{ccc|c} \green{3}&amp; \green{11} &amp; \green{5} &amp; \green{35} \\ \red{0}&amp; \red{14} &amp; \red{2} &amp; \red{32} \\ \blue{0}&amp; \blue{6.5} &amp; \blue{3.5} &amp; \blue{21.5} \end{array} \right]\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1"># swap
</span> <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,</span><span class="mi">1</span><span class="p">]))</span>
 <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">:,][</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> </li> <li>다시 전진소거 <ul> <li> <p>전진 소거의 기준이, 앞서 살펴보았듯 \(A_{22}\)부터 입니다. 즉,</p> \[\blue{A_{3,:}}\leftarrow\red{A_{2,:}}-A_{22}/A_{32}\times \blue{A_{3,:}}\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="n">icol</span><span class="o">=</span><span class="mi">1</span> <span class="c1"># A{:,2}
</span> <span class="n">irow</span><span class="o">=</span><span class="mi">2</span> <span class="c1"># A{3,:}
</span> <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> <p>즉 앞서 이어온 결과와 다 모아 행바꾸기, 전진 소거를 표현하자면 아래와 같다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1">#------------------------------------------------
</span> <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="c1"># initial empty A.
</span> <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
 <span class="c1"># filling up the matrix.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">9</span> <span class="c1">#1st row, irow=0
</span> <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="c1">#2nd row, irow=1
</span> <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span><span class="mi">35</span> <span class="c1">#3rd row, irow=2
</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="c1"># swap
</span> <span class="n">icol</span><span class="o">=</span><span class="mi">0</span>
 <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,</span><span class="n">icol</span><span class="p">]))</span>
 <span class="n">A</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
 <span class="c1"># forward
</span> <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">icol</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
     <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="c1"># swap
</span> <span class="n">icol</span><span class="o">=</span><span class="mi">1</span>
 <span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,</span><span class="n">icol</span><span class="p">]))</span>
 <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,][</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
 <span class="c1"># forward
</span> <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">icol</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
     <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">-</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">])</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> <p>여기서 icol=0,1로 바뀌며 동일한 코드가 반복되는 걸 알 수 있다.</p> </li> </ul> </li> <li>Swap/Forward 축약 표기 <ul> <li>앞 단계의 결과를 행렬의 크기와 swap/forward의 대상 행과 열을 고려하여 더욱 축약하자면 아래와 같이 표현된다.</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>   <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
   <span class="c1"># filling up the matrix.
</span>   <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span>
   <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
   <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">35</span>

   <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
       <span class="c1">## swap
</span>       <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,</span><span class="n">icol</span><span class="p">])</span> <span class="c1">## Based on [absolute values] of a portion of column
</span>       <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
       <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># reverse order
</span>       <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:][</span><span class="n">ind</span><span class="p">,:]</span>
       <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
       <span class="c1">## forward
</span>       <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">icol</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
           <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>
       <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
       <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">****************</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div> </div> <ul> <li>그 결과는 아래와 같다</li> </ul> \[\left[ \begin{array}{ccc|c} +3.00&amp; +11.00&amp; +5.00&amp; +35.00 \\ +0.00&amp; -4.67&amp; -0.67&amp; -10.67 \\ +0.00&amp; +0.00&amp; -1.71&amp; -4.43 \end{array} \right]\] </li> <li>Diagnalization <ul> <li>앞선 단계의 결과를 더욱 진행하여 대각선 값들을 제외하고 <code class="language-plaintext highlighter-rouge">0</code>을 만들 수 있다. 아래 코드를 참고하자.</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="c1"># now one could 'diagonalize'
</span> <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
     <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">icol</span><span class="p">):</span>
         <span class="n">f</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
         <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>
</code></pre></div> </div> <p>그 결과는 아래와 같다.</p> \[\left[ \begin{array}{ccc|c} +3.00&amp; -0.00&amp; +0.00&amp; +1.00 \\ +0.00&amp; -4.67&amp; +0.00&amp; -8.94 \\ +0.00&amp; +0.00&amp; -1.71&amp; -4.43 \end{array} \right]\] <p>정리하자면, 현재 연립 방정식은 아래와 같은 형태가 된 것이다.</p> \[\left[ \begin{array}{c} +3.00x=+1.00 \\ -4.67y=-8.94 \\ -1.71z=-4.43 \end{array} \right]\] <p>각 식을 풀기 위해서는 행렬의 대각선 값들을 각 행에 각가 나눠주면 되겠다. 즉 아래와 같은 수행을 하고 나면</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
     <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
</code></pre></div> </div> \[\left[ \begin{array}{ccc|c} +1.00&amp; -0.00&amp; +0.00&amp; +0.33 \\ -0.00&amp; +1.00&amp; -0.00&amp; +1.92 \\ -0.00&amp; -0.00&amp; +1.00&amp; +2.58 \end{array} \right]\] <p>가 되어 \((x,y,z)=(0.33,1.92,2.58)\) 해를 찾게 되었다.</p> </li> <li>전체 코드 <ul> <li>1-7 단계에 이르는 전체 코드를 살펴보자.</li> <li>python code</li> </ul> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">fmt</span><span class="o">=</span><span class="sh">'</span><span class="s">%+7.2f</span><span class="sh">'</span><span class="p">):</span>
     <span class="sh">"""</span><span class="s">
     Function to more neatly print out the matrix.
     </span><span class="sh">"""</span>
     <span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">--</span><span class="sh">'</span><span class="p">)</span>
     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">As</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
         <span class="n">cr</span><span class="o">=</span><span class="sh">''</span>
         <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">a</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">As</span><span class="p">):</span>
             <span class="n">cr</span><span class="o">=</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">cr</span><span class="si">}</span><span class="s"> </span><span class="si">{</span><span class="n">fmt</span><span class="si">}</span><span class="sh">'</span><span class="o">%</span><span class="n">a</span>
         <span class="nf">print</span><span class="p">(</span><span class="n">cr</span><span class="p">)</span>

 <span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
 <span class="c1"># initial empty A.
</span> <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
 <span class="c1"># filling up the matrix.
</span> <span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span>
 <span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
 <span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">35</span>
 <span class="c1">#show(A)
</span>
 <span class="c1"># swap and forward
</span> <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
     <span class="c1">## swap
</span>     <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,</span><span class="n">icol</span><span class="p">])</span>
     <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
     <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># reverse order
</span>     <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:][</span><span class="n">ind</span><span class="p">,:]</span>

     <span class="c1">## forward
</span>     <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">icol</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
         <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>

 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

 <span class="c1"># now one could 'diagonalize'
</span> <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
     <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">icol</span><span class="p">):</span>
         <span class="n">f</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
         <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
 <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
     <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
 <span class="nf">show</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div> </div> <p>** 덧붙이는 말: 중간에 row의 순서를 바꾸는 과정이 없는 알고리듬으로 구현한 웹 프로그램을 <a href="https://onlinemschool.com/math/assistance/equation/gaus/" rel="external nofollow noopener" target="_blank">여기</a>에서 찾을 수 있습니다.</p> </li> </ol> </li> </ul> </li> <li>가우스소거법 예제. <ul> <li> <p>위 코드를 활용해 아래를 풀어보자.</p> \[\left[ \begin{array}{cccc|c} +2 &amp; +3 &amp; +1 &amp; +9 &amp; -1 \\ -1 &amp; -1 &amp; -1 &amp; +1 &amp; +10 \\ +3 &amp; +3 &amp; -5 &amp; +35 &amp; +0 \\ +3 &amp; +4 &amp; +10 &amp; +3 &amp; -3 \end{array} \right]\] </li> </ul> </li> <li> <p>Numpy의 선형대수(Linear Algebra) 패키지 (<a href="https://numpy.org/doc/2.2/reference/routines.linalg.html" rel="external nofollow noopener" target="_blank">np.linalg</a>) 활용</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="c1"># filling up the matrix.
</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">9</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">35</span>
<span class="n">n</span><span class="o">=</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="c1">## determinant 를 구한다.
</span><span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">det:</span><span class="sh">'</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">det</span><span class="p">(</span><span class="n">A</span><span class="p">[:,:</span><span class="n">n</span><span class="p">]))</span>
<span class="c1"># Inverse matrix 구한 다음 곱하기.
</span><span class="n">root</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">inv</span><span class="p">(</span><span class="n">A</span><span class="p">[:,:</span><span class="n">n</span><span class="p">])</span><span class="nd">@A</span><span class="p">[:,</span><span class="n">n</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>

<span class="c1"># 혹은 solve를 활용해서
</span><span class="nf">print</span><span class="p">(</span><span class="n">np</span><span class="p">.</span><span class="n">linalg</span><span class="p">.</span><span class="nf">solve</span><span class="p">(</span><span class="n">A</span><span class="p">[:,:</span><span class="n">n</span><span class="p">],</span> <span class="n">A</span><span class="p">[:,</span><span class="n">n</span><span class="p">]))</span>
</code></pre></div> </div> </li> </ul> </li> </ul> </li> </ul> <h1 id="week6">Week6</h1> <h2 id="수업-06-1">수업 06-1</h2> <ul> <li>LU decomposition <ul> <li>Gauss 소거법과 더불어 설명되는 연립 방정식 풀이법</li> <li> <p>개념 \(\boldsymbol A\cdot \boldsymbol x = \boldsymbol b\)</p> <p>를 만족시키는 벡터 \(\boldsymbol x\)의 \(x_1,x_2,...,x_n\)을 구하는 방법 중에 하나로써, 행렬 \(\boldsymbol A\)를 아래와 같이 나뉘어 활용한다.</p> \[\boldsymbol A=\boldsymbol L \cdot \boldsymbol U\] <p>\(\boldsymbol L\): <strong>L</strong>ower triangular matrix (대각선을 따라서 1)</p> <p>\(\boldsymbol U\): <strong>U</strong>ower triangular matrix</p> <p>4x4행렬을 예로 들자면</p> \[\boldsymbol A = \begin{bmatrix} A_{11} &amp; A_{12} &amp; A_{13} &amp; A_{14}\\ A_{21} &amp; A_{22} &amp; A_{23} &amp; A_{24}\\ A_{31} &amp; A_{32} &amp; A_{33} &amp; A_{34} \\ A_{41} &amp; A_{42} &amp; A_{43} &amp; A_{44} \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ L_{21} &amp; 1 &amp; 0 &amp;0 \\ L_{31} &amp; L_{32} &amp; 1 &amp;0 \\ L_{41} &amp; L_{42} &amp; L_{43} &amp;1 \\ \end{bmatrix} \cdot \begin{bmatrix} U_{11} &amp; U_{12} &amp; U_{13} &amp; U_{14}\\ 0 &amp; U_{22} &amp; U_{23} &amp; U_{24} \\ 0 &amp; 0 &amp; U_{33} &amp; U_{34} \\ 0 &amp; 0 &amp; 0 &amp; U_{44} \\ \end{bmatrix}\] </li> <li> <p>예시</p> \[\boldsymbol A = \begin{bmatrix} 2&amp; 1&amp; 0 &amp; 3 \\ 4&amp; 4&amp; 1&amp; 7 \\ 2 &amp;-1&amp; 2 &amp;4 \\ 6 &amp; 7 &amp; 5&amp; 15 \end{bmatrix} = \begin{bmatrix} 1 &amp; 0 &amp; 0 &amp; 0\\ L_{21} &amp; 1 &amp; 0&amp;0 \\ L_{31} &amp; L_{32} &amp; 1 &amp;0 \\ L_{41} &amp; L_{42} &amp; L_{43} &amp; 1 \end{bmatrix} \cdot \begin{bmatrix} U_{11} &amp; U_{12} &amp; U_{13} &amp; U_{14}\\ 0 &amp; U_{22} &amp; U_{23} &amp; U_{24}\\ 0 &amp; 0 &amp; U_{33} &amp; U_{34} \\ 0 &amp; 0 &amp; 0 &amp; U_{44} \end{bmatrix}\] </li> </ul> </li> <li>Jacobi 법 <ul> <li>Newton-Raphson 처럼 반복하여 행렬 풀이</li> <li> <p>개념</p> \[\boldsymbol A \cdot \boldsymbol x = \boldsymbol b\] <p>\(\boldsymbol A\)가 \(n\times n\)행렬이라 하면, 각 행 \(i\)마다 아래 식이</p> \[\sum_{j=1}^nA_{ij}x_j=b_i\] <p>만족해야 함. 위 식을 바꿔 표현하여 각 행 \(i\)에 대해 아래와 같이 전개 가능함.</p> \[A_{ii}x_i+\sum_{j\ne i}^nA_{ij}x_j=b_i\] <p>만약 \(A_{ii}\ne 0\)이면, 고정되어 있는 한 행 $i$에 대한 위 식을 바꿔 \(x_i\)에 대해 표현하면</p> \[x_i=\frac{1}{A_{ii}}\bigg(b_i-\sum_{j\ne i}^nA_{ij}x_j\bigg)\] </li> <li> <p>반복 알고리듬 앞선 식에서 우변과 좌변의 \(\boldsymbol x\)벡터를 각각 직전\((k)\), 그리고 직후 \((k+1)\) 값으로 표현하면</p> \[x_i^{(k+1)}=\frac{1}{A_{ii}}\bigg(b_i-\sum_{j\ne i}^nA_{ij}x_j^{(k)}\bigg)\] <p>로 표현되며, 위 반복문을 활용해 \(\boldsymbol x\)를 평가함.</p> </li> <li> <p>예시: 2x2</p> \[\bigg( \begin{matrix} 4x_1+x_2=7 \ \ \text{eq. (1)}\\ x_1+3x_2=8 \ \ \text{eq. (2)} \end{matrix}\] <p>이라면 각 \(i=1,2\) 마다 아래 두 식이 성립된다.</p> \[x_1^{(k+1)}=\frac{1}{A_{11}}(b_1-\sum_{j\ne 1}A_{1j}x_j^{(k)})=\frac{1}{4}(7-\sum_{j\ne1}A_{1j}x_j^{(k)}) \ \ \ \ Eq. (1) \newline x_2^{(k+1)}=\frac{1}{A_{22}}(b_2-\sum_{j\ne 2}A_{2j}x_j^{(k)})=\frac{1}{3}(8-\sum_{j\ne2}A_{2j}x_{j}^{(k)}) \ \ \ \ Eq. (2)\] <p>초기값 \(\boldsymbol x^{(0)}=(0,0)\)으로 시작해보자.</p> <ul> <li>Iteration 1 <ul> <li> <p>식1</p> \[x_1^{(1)}=\frac{1}{4}(7-\sum_{j\ne 1}A_{1j}x_j^{(0)})=\frac{1}{4}\times 7=1.75\] </li> <li> <p>식2</p> \[x_2^{(k+1)}=\frac{1}{3}(8-\sum_{j\ne 2}A_{2j}x_j^{(k)})=\frac{1}{3}\times8\approx2.667\] </li> </ul> </li> <li>Iteration 2 <ul> <li> <p>식1</p> \[x_1^{(2)}=\frac{1}{4}(7-\sum_{j\ne 1}A_{1j}x_j^{(1)})=\frac{1}{4}(7-2.667)=1.083\] </li> <li> <p>식2</p> \[x_2^{(2)}=\frac{1}{3}(8-\sum_{j\ne 2}A_{2j}x_j^{(2)})=\frac{1}{3}(8-1.75)=2.083\] </li> </ul> </li> <li>… 반복</li> </ul> </li> <li>종료 조건: 오차의 수렴 <ul> <li> <p>오차 조건 1.</p> \[|\boldsymbol{A}\cdot\boldsymbol{x}^{(k+1)}-\boldsymbol{b}|&lt;Tol.\] </li> <li> <p>오차 조건 2.</p> \[|\boldsymbol{x}^{(k+1)}-\boldsymbol{x}^{(k)}| &lt; Tol.\] </li> </ul> </li> <li> <p>예시: 3x3</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c1"># filling up the matrix.
</span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,:]</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="o">-</span><span class="mi">11</span><span class="p">,</span><span class="mi">5</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,:]</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="o">-</span><span class="mi">20</span>

<span class="n">b</span><span class="p">[:]</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span>

<span class="n">ndim</span><span class="o">=</span><span class="n">b</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
<span class="n">tol</span><span class="o">=</span><span class="mf">1e-4</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="n">k</span><span class="o">=</span><span class="mi">0</span>
<span class="n">hist</span><span class="o">=</span><span class="p">[]</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span> <span class="n">tol</span> <span class="ow">and</span> <span class="n">k</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">:</span> <span class="c1"># max iter. set to 100
</span>    <span class="n">newx</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">ndim</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
        <span class="n">summation</span><span class="o">=</span><span class="mf">0.</span>
        <span class="k">for</span> <span class="n">jrow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">ndim</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">icol</span><span class="o">==</span><span class="n">jrow</span><span class="p">:</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">summation</span><span class="o">+=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">jrow</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">jrow</span><span class="p">]</span>
        <span class="n">newx</span><span class="p">[</span><span class="n">icol</span><span class="p">]</span><span class="o">=</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">icol</span><span class="p">]</span><span class="o">-</span><span class="n">summation</span><span class="p">)</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
        <span class="c1">#x[icol]=1/A[icol,icol]*(b[icol]-)
</span>    <span class="n">err</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(((</span><span class="n">newx</span><span class="o">-</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nf">sum</span><span class="p">())</span>
    <span class="n">Ea</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(((</span><span class="n">A</span><span class="nd">@newx</span><span class="o">-</span><span class="n">b</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nf">sum</span><span class="p">())</span>
    <span class="n">x</span><span class="p">[::]</span><span class="o">=</span><span class="n">newx</span><span class="p">[::]</span>
    <span class="n">hist</span><span class="p">.</span><span class="nf">append</span><span class="p">([</span><span class="n">err</span><span class="p">,</span><span class="n">Ea</span><span class="p">])</span>
    <span class="n">k</span><span class="o">+=</span><span class="mi">1</span>
<span class="n">hist</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>

<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">hist</span><span class="p">[:,</span><span class="mi">0</span><span class="p">],</span><span class="sh">'</span><span class="s">-x</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$|\boldsymbol{A}\cdot\boldsymbol{x}^{(k+1)}-\boldsymbol{b}|$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">hist</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="sh">'</span><span class="s">-o</span><span class="sh">'</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$|\boldsymbol{x}^{(k+1)}-\boldsymbol{x}^{(k)}|$</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> </li> </ul> </li> </ul> <h1 id="week7-중간고사">Week7 (중간고사)</h1> <ul> <li>중간고사 운영 지침 <ul> <li>개인 노트북 지참하여 시험 (인터넷 연결 x)</li> <li>chatGPT등 사용하여 cheating시에 F <h2 id="수업-07-1">수업 07-1</h2> <h2 id="수업-07-2">수업 07-2</h2> <h1 id="week8-multivariate-newton-raphson-method">Week8 (multivariate Newton-Raphson method)</h1> <h2 id="수업-08-1-build-your-own-multivariate-nr-function-1">수업 08-1 (Build your own multivariate NR function 1)</h2> </li> </ul> </li> <li>세상 모든 문제들이 선형적(linear)이다면 가우스 소거법을 활용해 풀이가 가능하니 참 좋겠지만, 그렇지 않다… 실은 대부분 흥미로운 일들은 비선형적이다.</li> <li> <p>예를 들어 다음 연립 방정식을 보자.</p> \[x^2+y^2=7 \newline e^x+y=8\] <p>이 두 식을 만족하는 \((x,y)\)좌표가 존재하는 것은 아래 Python 프로그램을 통해 쉽게 확인할 수 있다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="c1">## 1st line
</span><span class="n">ths</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Line1</span><span class="sh">'</span><span class="p">)</span>
<span class="c1">## 2nd line
</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sh">'</span><span class="s">Line2</span><span class="sh">'</span><span class="p">)</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">legend</span><span class="p">()</span>
</code></pre></div> </div> </li> <li>두선의 교점을 찾는 방법으로 multivariate Newton-Raphson method를 활용할 수 있다. <ul> <li>Single variate Newton-Raphson method는 이미 다루었다.</li> <li> <p>아래 알고리듬을 따르면 되었다.</p> \[x^{(n+1)}=x^{(n)}-\frac{f(x^{(n)})}{f^\prime(x^{(n)})}\] </li> <li>Multivariate Newton-Raphson method의 알고리듬도 유사한 형태이다. <ul> <li> <p>우선 앞서 다루었던 연립방정식을 아래와 같이 표현하자.</p> \[f_1(x_1,x_2)=x_1^2+x_2^2-7 \newline f_2(x_1,x_2)=e^{x_1}+x_2-8\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
  <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#
</span>  <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span>
  <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">x2</span><span class="o">-</span><span class="mi">8</span>
  <span class="k">return</span> <span class="n">f</span>
</code></pre></div> </div> </li> <li> <p>그런 다음 Jacobian matrix를 구하자. 이는 아래와 같이 정의된다.</p> \[J_{ij}=\frac{\partial f_i}{\partial x_j}\] <p>따라서,</p> \[J_{11}=\frac{\partial f_1}{\partial x_1}=2x_1 \newline J_{12}=\frac{\partial f_1}{\partial x_2}=2x_2 \newline J_{21}=\frac{\partial f_2}{\partial x_1}=e^{x_1} \newline J_{22}=\frac{\partial f_2}{\partial x_2}=1\] <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="c1"># 2x2 jacob
</span>    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">j</span>
</code></pre></div> </div> </li> <li> <p>그런 다음 아래 알고리듬을 따르면 된다.</p> \[x^{n+1}_1=x^{n}_1-J_{11}^{-1}f_1(x^n_1,x^n_2)-J_{12}^{-1}f_2(x^n_1,x^n_2) \newline x^{n+1}_2=x^{n}_2-J_{21}^{-1}f_1(x^n_1,x^n_2)-J_{22}^{-1}f_2(x^n_1,x^n_2)\] <p>위 식을 행렬식을 활용해 표현하자면 아래와 같다.</p> \[\begin{bmatrix} x_1^{n+1}\\ x_2^{n+1} \end{bmatrix} = \begin{bmatrix} x_1^{n}\\ x_2^{n} \end{bmatrix} - \begin{bmatrix} J_{11}(x_1^n,x_2^n) &amp; J_{12}(x_1^n,x_2^n) \\ J_{21}(x_1^n,x_2^n) &amp; J_{22}(x_1^n,x_2^n) \\ \end{bmatrix}^{-1} \cdot \begin{bmatrix} f_1(x_1^n,x_2^n)\\ f_2(x_1^n,x_2^n) \end{bmatrix}\] <p>아래와 같이 좀 더 간략히 아래와 같이 표기해보자.</p> \[\begin{bmatrix} \boldsymbol x^{n+1} \end{bmatrix} = \begin{bmatrix} \boldsymbol x^{n} \end{bmatrix} - \begin{bmatrix} \boldsymbol J \end{bmatrix}^{-1} \cdot \begin{bmatrix} \boldsymbol f \end{bmatrix}\] <p>행렬과 벡터를 재배치 해보면…</p> \[\begin{bmatrix} \boldsymbol J \end{bmatrix} \cdot \begin{pmatrix} \begin{bmatrix} \boldsymbol x^{n+1} \end{bmatrix} - \begin{bmatrix} \boldsymbol x^{n} \end{bmatrix} \end{pmatrix} = \begin{bmatrix} \boldsymbol f \end{bmatrix}\] <p>벡터의 변화량 \(\Delta \boldsymbol x\)를 활용하면</p> \[\begin{bmatrix} \boldsymbol J \end{bmatrix} \cdot \begin{bmatrix} \Delta \boldsymbol x \end{bmatrix} = -\begin{bmatrix} \boldsymbol f \end{bmatrix}\] <p>로 표현 가능하다. 따라서, 앞서 배운 Gauss 소거법 등을 통해, 역행렬을 계산하지 않고, \([\Delta \boldsymbol x]\)를 구할 수 있다. 그렇게 하기 위해서 아래 정의된 <code class="language-plaintext highlighter-rouge">guass</code>함수를 활용하자.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">gauss</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Gauss elimination

    Arguments
    --------
    A: augmented matrix in  [n,n+1] dimension

    Returns
    -------
    Root in [n]-dimensional vector.
    </span><span class="sh">"""</span>
    <span class="c1"># swap and forward
</span>    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1">## swap
</span>        <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">abs</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,</span><span class="n">icol</span><span class="p">])</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">argsort</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="n">ind</span><span class="o">=</span><span class="n">ind</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># reverse order
</span>        <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">:,:][</span><span class="n">ind</span><span class="p">,:]</span>

        <span class="c1">## forward
</span>        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">icol</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>
    <span class="c1"># now one could 'diagonalize'
</span>    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">irow</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">icol</span><span class="p">):</span>
            <span class="n">f</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
            <span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">irow</span><span class="p">,:]</span><span class="o">-</span><span class="n">f</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span>
    <span class="k">for</span> <span class="n">icol</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">=</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,:]</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">icol</span><span class="p">,</span><span class="n">icol</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div> </div> <p>위 <code class="language-plaintext highlighter-rouge">gauss</code>함수를 활용해 풀이한 예시이다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="c1">## Canvas
</span>
<span class="c1">## 1st line
</span><span class="n">ths</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">,</span><span class="n">np</span><span class="p">.</span><span class="n">pi</span><span class="p">)</span>
<span class="n">r</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">cos</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sin</span><span class="p">(</span><span class="n">ths</span><span class="p">)</span><span class="o">*</span><span class="n">r</span>

<span class="c1">## 2nd line
</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span><span class="mi">8</span><span class="o">-</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1">## Function and Jacobian required for NR procedure
</span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
    <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#
</span>    <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">x1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">x2</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">7</span>
    <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span><span class="o">+</span><span class="n">x2</span><span class="o">-</span><span class="mi">8</span>
    <span class="k">return</span> <span class="n">f</span>
<span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">):</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span> <span class="c1"># 2x2 jacob
</span>    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x1</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x2</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">exp</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">j</span>

<span class="c1">## NEWTON-RAPHSON begins here.
# hist arrays for recording changes.
## Initial guess
</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">## initial guess
</span><span class="n">x</span><span class="p">[::]</span><span class="o">=-</span><span class="mf">1.0</span> <span class="c1">## initial guess
</span>
<span class="c1"># Tolerance setting
</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-9</span>
<span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
<span class="c1">#
</span><span class="n">n</span><span class="o">=</span><span class="mi">0</span>
<span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span> <span class="ow">and</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">50</span><span class="p">:</span>
    <span class="c1"># jacobian and functions
</span>    <span class="n">J</span><span class="o">=</span><span class="nf">jacob</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
    <span class="n">F</span><span class="o">=</span><span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># Create augmented matrix A
</span>    <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">J</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">J</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">J</span><span class="p">[:,:]</span>
    <span class="n">A</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">F</span><span class="p">[::]</span>

    <span class="c1"># Obtain Delta x via guass elimination method
</span>    <span class="n">dx</span><span class="o">=</span><span class="nf">gauss</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

    <span class="c1"># Update x
</span>    <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span>
    <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>

    <span class="c1"># estimate the error
</span>    <span class="n">err</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">((</span><span class="n">F</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nf">sum</span><span class="p">())</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">solution:</span><span class="sh">'</span><span class="p">,</span><span class="n">x</span><span class="p">)</span>
</code></pre></div> </div> </li> </ul> </li> </ul> </li> <li>Multivariate NR method를 함수화시키자. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">mvNR</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">func_jac</span><span class="p">,</span><span class="n">xinit</span><span class="p">):</span>
    <span class="sh">"""</span><span class="s">
    Arguments
    ---------
    func: objective function
    func_jac: jacobian
    xinit: initial guess on x vectors.

    Returns
    -------
    x     : solution vector
    hist  : trajectory of x vector
    fhist : trajectory of f vector
    </span><span class="sh">"""</span>
    <span class="n">x</span><span class="o">=</span><span class="n">xinit</span><span class="p">[::]</span>
    <span class="c1"># hist arrays for recording changes.
</span>    <span class="n">hist</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">fhist</span><span class="o">=</span><span class="p">[]</span>
    <span class="c1"># Tolerance setting
</span>    <span class="n">tol</span><span class="o">=</span><span class="mf">1e-9</span>
    <span class="n">err</span><span class="o">=</span><span class="n">tol</span><span class="o">*</span><span class="mi">2</span>
    <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
    <span class="n">maxiter</span><span class="o">=</span><span class="mi">50</span>
    <span class="k">while</span> <span class="n">err</span><span class="o">&gt;</span><span class="n">tol</span> <span class="ow">and</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">maxiter</span><span class="p">:</span>
        <span class="c1"># jacobian and functions
</span>        <span class="n">J</span><span class="o">=</span><span class="nf">jacob</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
        <span class="n">F</span><span class="o">=</span><span class="nf">func</span><span class="p">(</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

        <span class="c1"># history
</span>        <span class="n">hist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">fhist</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">F</span><span class="p">)</span>

        <span class="c1"># Create augmented matrix A
</span>        <span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="n">J</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">J</span><span class="p">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">A</span><span class="p">[:</span><span class="mi">2</span><span class="p">,:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">J</span><span class="p">[:,:]</span>
        <span class="n">A</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="n">F</span><span class="p">[::]</span>

        <span class="c1"># Obtain Delta x via guass elimination method
</span>        <span class="n">dx</span><span class="o">=</span><span class="nf">gauss</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

        <span class="c1"># updates x, count (n), and error
</span>        <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="o">+</span><span class="n">dx</span>
        <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">err</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">((</span><span class="n">F</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nf">sum</span><span class="p">())</span>

    <span class="n">hist</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">hist</span><span class="p">)</span>
    <span class="n">fhist</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">fhist</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">,</span><span class="n">hist</span><span class="p">,</span><span class="n">fhist</span>
</code></pre></div> </div> </li> <li> <p><code class="language-plaintext highlighter-rouge">mvNR</code>함수를 앞선 <code class="language-plaintext highlighter-rouge">guass</code>함수와 함께 사용한다면 아래와 같이 매우 짧은 몇 줄의 코드로 앞선 예제를 작성할 수 있다. 따라서 한번 작성해 놓은 함수를 다시 사용할 수 있게 되었다. 학생들이 이 경험을 통해 모듈화의 이점을 몸소 체험해 보길 바란다.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>  <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="mi">10</span>
<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>  <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">3</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">y</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">j</span>

<span class="c1">## NEWTON-RAPHSON begins here.
## Initial guess
</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">## initial guess
</span><span class="n">x</span><span class="p">[::]</span><span class="o">=</span><span class="mf">4.0</span> <span class="c1">## initial guess
</span><span class="n">x</span><span class="p">,</span><span class="n">hist</span><span class="p">,</span><span class="n">fhist</span><span class="o">=</span><span class="nf">mvNR</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">jacob</span><span class="p">,</span><span class="n">xinit</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div> </div> </li> </ul> <h2 id="수업-08-2-geomtric-interpretation-of-multivariate-nr">수업 08-2 (Geomtric interpretation of multivariate NR)</h2> <ul> <li>앞선 예제를 기하학적으로 해석하자.</li> <li> <p>우선 정형화된 아래 2D 그래프 생선 함수를 사용하자.</p> <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> <span class="k">def</span> <span class="nf">init_fig</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">):</span>
     <span class="n">fig</span><span class="o">=</span><span class="n">plt</span><span class="p">.</span><span class="nf">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
     <span class="n">ax1</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span><span class="c1">#,projection='3d')
</span>     <span class="n">ax2</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax3</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span><span class="c1">#,projection='3d')
</span>     <span class="n">ax4</span><span class="o">=</span><span class="n">fig</span><span class="p">.</span><span class="nf">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span><span class="n">projection</span><span class="o">=</span><span class="sh">'</span><span class="s">3d</span><span class="sh">'</span><span class="p">)</span>

     <span class="c1"># Grid
</span>     <span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
     <span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
     <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">meshgrid</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

     <span class="c1">## 2D contour plot
</span>     <span class="n">mappable</span><span class="o">=</span><span class="n">ax1</span><span class="p">.</span><span class="nf">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="nf">f1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">jet</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax1</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_1(x_1,x_2)$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax1</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax1</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_2$</span><span class="sh">'</span><span class="p">)</span>
     <span class="c1">## 3D plane
</span>     <span class="n">ax2</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="nf">f1</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">jet</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax2</span><span class="p">.</span><span class="nf">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax2</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax2</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_2$</span><span class="sh">'</span><span class="p">)</span>

     <span class="c1">## 2D contour plot
</span>     <span class="n">mappable</span><span class="o">=</span><span class="n">ax3</span><span class="p">.</span><span class="nf">contourf</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="nf">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">jet</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">plt</span><span class="p">.</span><span class="nf">colorbar</span><span class="p">(</span><span class="n">mappable</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_2$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax3</span><span class="p">.</span><span class="nf">set_title</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_2(x_1,x_2)$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax3</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax3</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_2$</span><span class="sh">'</span><span class="p">)</span>
     <span class="c1">## 3D plane
</span>     <span class="n">ax4</span><span class="p">.</span><span class="nf">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="nf">f2</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">),</span><span class="n">cmap</span><span class="o">=</span><span class="sh">'</span><span class="s">jet</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax4</span><span class="p">.</span><span class="nf">set_zlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$f_2$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax4</span><span class="p">.</span><span class="nf">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_1$</span><span class="sh">'</span><span class="p">)</span>
     <span class="n">ax4</span><span class="p">.</span><span class="nf">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">$x_2$</span><span class="sh">'</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">fig</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span>
</code></pre></div> </div> </li> <li>아래 예제를 활용해보자 <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>  <span class="k">return</span> <span class="n">x</span><span class="o">*</span><span class="n">y</span><span class="o">-</span><span class="mi">10</span>
<span class="k">def</span> <span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>  <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">y</span><span class="o">-</span><span class="mi">3</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span> <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="nf">f1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">),</span><span class="nf">f2</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)])</span>
<span class="k">def</span> <span class="nf">jacob</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">):</span>
    <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">y</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">x</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span>
    <span class="n">j</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
    <span class="k">return</span> <span class="n">j</span>

<span class="c1">## NEWTON-RAPHSON begins here.
## Initial guess
</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="c1">## initial guess
</span><span class="n">x</span><span class="p">[::]</span><span class="o">=</span><span class="mf">4.0</span> <span class="c1">## initial guess
</span><span class="n">x</span><span class="p">,</span><span class="n">hist</span><span class="p">,</span><span class="n">fhist</span><span class="p">,</span><span class="n">jhist</span><span class="p">,</span><span class="n">niters</span><span class="o">=</span><span class="nf">mvNR</span><span class="p">(</span><span class="n">func</span><span class="p">,</span><span class="n">jacob</span><span class="p">,</span><span class="n">xinit</span><span class="o">=</span><span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">niters: </span><span class="si">{</span><span class="n">niters</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>

<span class="c1">## Below is to create figures
</span><span class="o">%</span><span class="n">matplotlib</span> <span class="n">widget</span>
<span class="c1">#%matplotlib inline
</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax1</span><span class="p">,</span><span class="n">ax2</span><span class="p">,</span><span class="n">ax3</span><span class="p">,</span><span class="n">ax4</span><span class="o">=</span><span class="nf">init_fig</span><span class="p">(</span><span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="p">)</span>

<span class="n">kws</span><span class="o">=</span><span class="nf">dict</span><span class="p">(</span><span class="n">mfc</span><span class="o">=</span><span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">,</span><span class="n">zorder</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="sh">'</span><span class="s">None</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="n">hist</span><span class="p">):</span>
    <span class="n">f1</span><span class="p">,</span><span class="n">f2</span><span class="o">=</span><span class="n">fhist</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
    <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="o">=</span><span class="n">x</span>

    <span class="n">kws</span><span class="p">.</span><span class="nf">update</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="sh">'</span><span class="s">$n$=%i</span><span class="sh">'</span><span class="o">%</span><span class="n">n</span><span class="p">)</span>
    <span class="n">ax1</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="n">ax2</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">f1</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="n">ax3</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="n">ax4</span><span class="p">.</span><span class="nf">plot</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">f2</span><span class="p">,</span><span class="o">**</span><span class="n">kws</span><span class="p">)</span>

<span class="n">ax1</span><span class="p">.</span><span class="nf">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="sh">'</span><span class="s">upper left</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div> </div> </li> <li>아래 그림을 보고 어떠한 일이 일어나고 있는지 이해해보자. <img src="/assets/dat_files/lectures/2_1_numerical_analysis/mvNR.gif" alt="imag"> </li> </ul> <h1 id="week9-nr-method-in-case-you-dont-know-the-derivative">Week9, (NR method in case you don’t know the derivative).</h1> <h2 id="수업-09-1-1d-nr-without-knowing-the-derivative">수업 09-1 (1D NR without knowing the derivative)</h2> <h2 id="수업-09-2">수업 09-2</h2> <h1 id="week10">Week10</h1> <h2 id="수업-10-1">수업 10-1</h2> <h2 id="수업-10-2">수업 10-2</h2> <h1 id="week11">Week11</h1> <h2 id="수업-11-1">수업 11-1</h2> <h2 id="수업-11-2">수업 11-2</h2> <h1 id="week12">Week12</h1> <h2 id="수업-12-1">수업 12-1</h2> <h2 id="수업-12-2">수업 12-2</h2> <h1 id="week13-포탄의-trajectory">Week13 (포탄의 trajectory?)</h1> <h2 id="수업-13-1">수업 13-1</h2> <h2 id="수업-13-2">수업 13-2</h2> <h1 id="week14-diffusion">Week14 (Diffusion?)</h1> <h2 id="수업-14-1">수업 14-1</h2> <h2 id="수업-14-2">수업 14-2</h2> <h1 id="week15">Week15</h1> <h2 id="수업-15-1">수업 15-1</h2> <h2 id="수업-15-2">수업 15-2</h2> </article> </div> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 . Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. Last updated: August 29, 2025. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-3ZBKY64YVH"></script> <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());

    gtag('config', 'G-3ZBKY64YVH');
  </script> <script defer src="/assets/js/google-analytics-setup.js"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>